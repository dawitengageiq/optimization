{"version":3,"sources":["revenue_statistics.js"],"names":["$","document","ready","the_url","html","revStatsTable","DataTable","processing","serverSide","order","searching","ajax","url","type","data","d","campaign_id","val","affiliate_id","lead_status","containing_data","s1","s2","s3","s4","s5","lead_date_from","lead_date_to","date_range","group_by","group_by_column","table","affiliate_type","sib_s1","prop","sib_s2","sib_s3","sib_s4","show_inactive_campaign","dataSrc","json","removeClass","console","log","column","footer","totalLeadCount","totalCost","totalRevenue","totalProfit","removeAttr","error","lengthMenu","submit","e","preventDefault","from_date","to_date","this_button","addClass","attr","reload","change","this","click","form","find","trigger","leadID","getDetailsURL","success","undefined","leadDataCSV","value","leadMessage","leadDataADV","leadSentResult","modal","datepicker","format","clearBtn","autoclose","todayHighlight","select2","theme","on","show","hide"],"mappings":"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","file":"revenue_statistics.min.js","sourcesContent":["$(document).ready(function()\r\n{\r\n    var the_url = $('#baseUrl').html() + '/getRevenueStatistics';\r\n    var revStatsTable = $('#revStats-table').DataTable({\r\n        'processing': true,\r\n        'serverSide': true,\r\n        \"order\": [[ 0, \"desc\" ]],\r\n        \"searching\": false,\r\n        // \"info\":     false,\r\n        'ajax':{\r\n            url:the_url, // json datasource\r\n            type: 'post',\r\n            // 'data': $('#search-leads').serialize(),\r\n            'data': function(d)\r\n            {\r\n                d.campaign_id = $('#realCampaignId').val();\r\n                d.affiliate_id = $('#affiliate_id').val();\r\n                d.lead_status = $('#lead_status').val();\r\n                d.containing_data = $('#containing_data').val();\r\n                d.s1 = $('#s1').val();\r\n                d.s2 = $('#s2').val();\r\n                d.s3 = $('#s3').val();\r\n                d.s4 = $('#s4').val();\r\n                d.s5 = $('#s5').val();\r\n                d.lead_date_from = $('#lead_date_from').val();\r\n                d.lead_date_to = $('#lead_date_to').val();\r\n                d.date_range = $('#date_range').val();\r\n                d.group_by = $('#group_by').val();\r\n                d.group_by_column = $('#group_by_column').val();\r\n                d.table = $('#table').val();\r\n                d.affiliate_type = $('#affiliate_type').val();\r\n                d.sib_s1 = $('#sib_s1').prop('checked');\r\n                d.sib_s2 = $('#sib_s2').prop('checked');\r\n                d.sib_s3 = $('#sib_s3').prop('checked');\r\n                d.sib_s4 = $('#sib_s4').prop('checked');\r\n\r\n                if($('#show_inactive_campaign').prop('checked')) {\r\n                    d.show_inactive_campaign = 1;\r\n                }\r\n            },\r\n            \"dataSrc\": function ( json ) {\r\n                // alert(\"Done!\");\r\n                $('#downloadRevenueReport').removeClass('disabled');\r\n                console.log(json);\r\n                $(revStatsTable.column(14).footer()).html(json.totalLeadCount);\r\n                $(revStatsTable.column(15).footer()).html(json.totalCost);\r\n                $(revStatsTable.column(16).footer()).html(json.totalRevenue);\r\n                $(revStatsTable.column(17).footer()).html(json.totalProfit);\r\n                $('#generateReportBtn').removeAttr('disabled');\r\n                return json.data;\r\n            },\r\n            error: function(data){  // error handling\r\n                console.log(data);\r\n            }\r\n        },\r\n        lengthMenu: [[25,50,100,1000,2000,3000],[25,50,100,1000,2000,3000]],\r\n    });\r\n\r\n    $('#revStats-form').submit(function(e)\r\n    {\r\n        e.preventDefault();\r\n        var from_date = $('#lead_date_from').val(),\r\n            to_date = $('#lead_date_to').val(),\r\n            this_button = $('#generateReportBtn');\r\n\r\n\r\n        if(from_date == '' || to_date == '') {\r\n            //remove the currently selected ordering\r\n            $('#downloadRevenueReport').addClass('disabled');\r\n            this_button.attr('disabled',true);\r\n            revStatsTable.order([]);\r\n            revStatsTable.ajax.reload();\r\n        }\r\n        else if(from_date != '' && to_date != '' && to_date >= from_date) {\r\n            $('label[for=\"lead_date_from\"]').removeClass('error_label error');\r\n            $('#lead_date_from').removeClass('error_field error');\r\n            $('label[for=\"lead_date_to\"]').removeClass('error_label error');\r\n            $('#lead_date_to').removeClass('error_field error');\r\n\r\n            //remove the currently selected ordering\r\n            $('#downloadRevenueReport').addClass('disabled');\r\n            this_button.attr('disabled',true);\r\n            revStatsTable.order([]);\r\n            revStatsTable.ajax.reload();\r\n        }else {\r\n            $('label[for=\"lead_date_from\"]').addClass('error_label error');\r\n            $('#lead_date_from').addClass('error_field error');\r\n            $('label[for=\"lead_date_to\"]').addClass('error_label error');\r\n            $('#lead_date_to').addClass('error_field error');\r\n        }\r\n    });\r\n\r\n    $('#date_range').change(function() {\r\n        if($(this).val() != '') {\r\n            $('#lead_date_from').val('');\r\n            $('#lead_date_to').val('');\r\n        }\r\n    });\r\n\r\n    $('.lead_date').change(function() {\r\n        if($(this).val() != '') {\r\n            $('#date_range').val('');\r\n        }\r\n    });\r\n\r\n    $('#clear').click(function()\r\n    {\r\n        var form = $('#revStats-form');\r\n\r\n        form.find('input:text, input:password, input:file, select, textarea').val('');\r\n        $('#group_by').val('date');\r\n\r\n        form.find('input:radio, input:checkbox').removeAttr('checked').removeAttr('selected');\r\n        $('#realCampaignId').val('');\r\n        $('.campaignField').trigger('change.select2');\r\n    });\r\n\r\n    $('.show-details').click(function()\r\n    {\r\n        var leadID = $(this).data('lead_id');\r\n        var getDetailsURL = $('#baseUrl').val()+'/admin/leads/'+leadID+'/getLeadDetails';\r\n\r\n        console.log(leadID);\r\n\r\n        $('#id').val(leadID);\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: getDetailsURL,\r\n            success: function(data)\r\n            {\r\n                console.log(data);\r\n\r\n                if(data.leadDataCSV!==undefined || data.leadDataCSV!==null)\r\n                {\r\n                    $('#lead_csv').val(data.leadDataCSV.value)\r\n                }\r\n\r\n                if(data.leadMessage!==undefined || data.leadMessage!==null)\r\n                {\r\n                    $('#message').val(data.leadMessage.value)\r\n                }\r\n\r\n                if(data.leadDataADV!==undefined || data.leadDataADV!==null)\r\n                {\r\n                    $('#advertiser_data').val(data.leadDataADV.value)\r\n                }\r\n\r\n                if(data.leadSentResult!==undefined || data.leadSentResult!==null)\r\n                {\r\n                    $('#sent_result').val(data.leadSentResult.value)\r\n                }\r\n            },\r\n            error: function(data)\r\n            {\r\n                console.log(data);\r\n            }\r\n        });\r\n\r\n        $('#lead_details_modal').modal('show');\r\n    });\r\n\r\n    $('.input-group.date').datepicker({\r\n        format: \"yyyy-mm-dd\",\r\n        clearBtn: true,\r\n        autoclose: true,\r\n        todayHighlight: true\r\n    });\r\n\r\n    $('.campaignField').select2({\r\n        theme: 'bootstrap'\r\n    });\r\n\r\n    $('#group_by_column').change(function()\r\n    {\r\n        if($(this).val() != '') {\r\n            $('.sibs').prop('checked', true).attr('disabled', true);\r\n        }else {\r\n            $('.sibs').removeAttr('disabled');\r\n        }\r\n    });\r\n\r\n    $(document).on('change','#show_inactive_campaign',function(e)\r\n    {\r\n        console.log($(this).prop('checked'))\r\n        if($(this).prop('checked')) {\r\n            $('#showAllCampaigns-container').show();\r\n            $('#showActiveCampaigns-container').hide();\r\n            $('#realCampaignId').val($('[name=\"fake_campaign_id_all\"]').val());\r\n        }else {\r\n            $('#showAllCampaigns-container').hide();\r\n            $('#showActiveCampaigns-container').show();\r\n            $('#realCampaignId').val($('[name=\"fake_campaign_id_active\"]').val());\r\n        }\r\n    });\r\n\r\n    $(document).on('change','[name=\"fake_campaign_id_all\"]',function(e)\r\n    {\r\n        console.log('all');\r\n        console.log($(this).val())\r\n        if($('#show_inactive_campaign').prop('checked')) {\r\n            $('#realCampaignId').val($('[name=\"fake_campaign_id_all\"').val());\r\n            console.log('update the other one');\r\n            $('[name=\"fake_campaign_id_active\"]').val($(this).val()).trigger('change');\r\n        }\r\n        \r\n    });\r\n\r\n    $(document).on('change','[name=\"fake_campaign_id_active\"]',function(e)\r\n    {\r\n        console.log('active');\r\n        console.log($(this).val())\r\n        if(!$('#show_inactive_campaign').prop('checked')) {\r\n            $('#realCampaignId').val($('[name=\"fake_campaign_id_active\"').val());\r\n            console.log('update the other one');\r\n            $('[name=\"fake_campaign_id_all\"]').val($(this).val()).trigger('change');\r\n        }\r\n    });\r\n});"]}