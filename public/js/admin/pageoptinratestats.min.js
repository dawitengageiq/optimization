$(function(){var e=parseInt($("#totalCampaignTypeCountCol").val()),a=[],t="",r=e;for(x=7;x<=e+2;x++)a.push(x),t+=x+",";var l=null,n=null,o=$.parseJSON($("#campaignLinkoutIds").val()),i=$.parseJSON($("#current_benchmarks").val());$('[data-toggle="tooltip"]').tooltip();var c=$("#pageOptInRateStats-table").DataTable({processing:!0,serverSide:!0,autoWidth:!1,searching:!1,columnDefs:[{orderable:!1,targets:[8,9,10,11,12,13,14,15,16,17,18,19,20]}],deferLoading:0,ajax:{url:$("#baseUrl").html()+"/admin/pageOptIn",type:"post",data:function(e){e.campaign_type=l,e.campaign=n,e.affiliate_id=$("#affiliate_id").val(),e.date_from=$("#date_from").val(),e.date_to=$("#date_to").val(),e.group_by=$("#group_by").val(),e.date_range=$("#date_range").val(),e.sib_s1=$("#sib_s1").prop("checked"),e.sib_s2=$("#sib_s2").prop("checked"),e.sib_s3=$("#sib_s3").prop("checked"),e.sib_s4=$("#sib_s4").prop("checked");var a=new Array,t=new Array;$(".campaign_type_benchmark").each(function(e,r){var l=$(r).data("type"),n=$(r).val();if(""!==n||n.trim().length>0){if(5==l||6==l){var i=new Array;$.each(n,function(e,a){i.push(o[a])}),t[l]=i}$.inArray("all",n)>=0&&(n=$('[name="benchmark['+l+'][]"] option').map(function(){return $(this).val()}).get()),a[l]=n}}),e.benchmarks=a,e.offer_ids=t},dataSrc:function(a){c.columns().visible(!0),$.each(a.hiddenCols,function(e,a){var t=c.column($("th.col-ct-"+a));t.visible(!1)}),r=e-a.hiddenCols.length;var t=a.benchmarks;return $.each(t,function(e,a){$('[name="benchmark['+e+']"]').val(a)}),$("#downloadPageOptInRateReport").removeAttr("disabled"),$("#poisDateLabel").html(a.date),$(".campaign_type_column").html(""),$.each(a.benchmarks,function(e,a){$.inArray("all",a)>=0?(a=["all"],label='<span class="label label-default bch-label benchmark-label" data-toggle="tooltip" data-placement="bottom" title="All">All</span><br>',$(".col-ct-"+e).append(label)):$.each(a,function(a,t){var r=$('[name="benchmark['+e+'][]"] option[value="'+t+'"]').html();cmp_name_prev=r.substr(0,10),r.length>10&&(cmp_name_prev+="..."),label='<span class="label label-default bch-label benchmark-label" data-toggle="tooltip" data-placement="bottom" title="'+r+'">'+cmp_name_prev+"</span><br>",$(".col-ct-"+e).append(label)}),$('[name="benchmark['+e+'][]"]').val(a).trigger("change")}),$('[data-toggle="tooltip"]').tooltip(),i=a.benchmarks,a.data},error:function(e){console.log(e)}},lengthMenu:[[25,50,100,1e3,2e3,3e3],[25,50,100,1e3,2e3,3e3]],sDom:'<"pageOptInStats_displayDate">l<"pageOptInStats_Toolbar">frtip'});$(".campaign_type_benchmark").select2(),$("div.pageOptInStats_Toolbar").html('<button type="button" class="openBenchmarkBtn btn btn-default btn-xs" data-toggle="modal" data-target="#benchmarkModal"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></button><button id="refreshPageOptInRateStatsBtn" type="button" class="btn btn-default btn-xs"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button>'),$("div.pageOptInStats_displayDate").html('<label>Displaying <span id="poisDateLabel"></span></label>'),$(document).on("click","#refreshPageOptInRateStatsBtn",function(){console.log("Refresh"),c.clear(),c.ajax.reload()}),$("#pageOptInRate-form").submit(function(e){e.preventDefault(),$("#downloadPageOptInRateReport").attr("disabled",!0),c.order([]),c.ajax.reload()}),$("#generateReportBtn").click(function(e){e.preventDefault();var a=$("#date_from").val(),t=$("#date_to").val(),r=$("#pageOptInRate-form");$('label[for="date_from"]').removeClass("error_label error"),$("#date_from").removeClass("error_field error"),$('label[for="date_to"]').removeClass("error_label error"),$("#date_to").removeClass("error_field error"),""==a||""==t?r.submit():""!=a&&""!=t&&t>=a?($('label[for="date_from"]').removeClass("error_label error"),$("#date_from").removeClass("error_field error"),$('label[for="date_to"]').removeClass("error_label error"),$("#date_to").removeClass("error_field error"),r.submit()):($('label[for="date_from"]').addClass("error_label error"),$("#date_from").addClass("error_field error"),$('label[for="date_to"]').addClass("error_label error"),$("#date_to").addClass("error_field error"))}),$("#affiliate_id").select2({placeholder:"Select the id or name of the affiliate.",minimumInputLength:1,theme:"bootstrap",language:{inputTooShort:function(e){return"Please enter the id or name of the affiliate. (Enter 1 or more characters)"}},ajax:{url:$("#baseUrl").html()+"/search/select/activeAffiliatesIDName",dataType:"json",type:"POST",data:function(e){var a={term:e.term};return a},processResults:function(e){return{results:$.map(e.items,function(e){return{text:e.name,id:e.id}})}}}}),$(".input-group.date").datepicker({format:"yyyy-mm-dd",clearBtn:!0,autoclose:!0,todayHighlight:!0}),$("#clear").click(function(){$(".input-group.date input").val(""),$("#affiliate_id").val("").trigger("change"),$("#group_by").val("day")}),$("#remove_affiliate_id_selections").click(function(){$("#affiliate_id").val(null).trigger("change")}),$("#date_range").change(function(){""!=$(this).val()&&($("#date_from").val(""),$("#date_to").val(""))}),$(".lead_date").change(function(){""!=$(this).val()&&$("#date_range").val("")}),$(document).on("click","#updateBenchmarkBtn",function(){c.clear(),c.ajax.reload(),$("#benchmarkModal").modal("hide")}),$("#benchmarkModal").on("hide.bs.modal",function(e){$.each(i,function(e,a){$.inArray("all",a)>=0&&(a=["all"]),$('[name="benchmark['+e+'][]"]').val(a).trigger("change")})}),$(document).on("click","#selectAllBenchmarkBtn",function(e){e.preventDefault(),$(".campaign_type_benchmark").each(function(e,a){$(this).val("all").trigger("change")})}),$("#group_by").change(function(){"day"!=$(this).val()?$(".sibs").prop("checked",!0).attr("disabled",!0):$(".sibs").removeAttr("disabled")})});
//# sourceMappingURL=pageoptinratestats.min.js.map
