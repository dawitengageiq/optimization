{"version":3,"sources":["affiliaterequest.js"],"names":["populateAffiliateRequestDataTable","table_name","status","remove_column","dataApplyToRunURL","$","html","DataTable","processing","serverSide","columns","orderable","ajax","url","type","data","error","columnDefs","targets","visible","lengthMenu","processIdentifier","process","approveAffiliateApplyToRunRequest","rejectAffiliateApplyToRunRequest","revertAffiliateApplyToRunRequest","alert","request_id","pendingTable","row","parents","remove","draw","updatedActiveTable","modal","updatedRejectTable","console","log","rejectedTable","reload","updatedDeactivatedTable","document","ready","activeTable","deactivatedTable","baseURL","click","activeTableName","fn","isDataTable","hide","show","rejectedTableName","deactivatedTableName","on","e","preventDefault","form","this","the_data","serialize","attr","success","removeClass","id","val","description","addClass"],"mappings":"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","file":"affiliaterequest.min.js","sourcesContent":["var updatedActiveTable = 0, updatedRejectTable = 0, updatedDeactivatedTable = 0;\r\n\r\nfunction populateAffiliateRequestDataTable(table_name, status, remove_column) {\r\n\tvar dataApplyToRunURL = $('#baseUrl').html() + '/apply_to_run';\r\n\treturn $(table_name).DataTable({\r\n\t\t'processing': true,\r\n\t\t'serverSide': true,\r\n\t\t\"columns\": [\r\n\t\t\tnull,\r\n\t\t\tnull,\r\n\t\t\tnull,\r\n\t\t\tnull,\r\n\t\t\t{ \"orderable\": false }\r\n\t\t],\r\n\t\t'ajax':{\r\n\t\t\turl:dataApplyToRunURL, // json datasource\r\n\t\t\ttype: 'post',  // method  , by default get\r\n\t\t\tdata: {\r\n\t\t\t\tstatus : status\r\n\t\t\t},\r\n\t\t\terror: function(){  // error handling\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"columnDefs\": [\r\n\t\t{\r\n            \"targets\": [ remove_column ],\r\n            \"visible\": false\r\n        }],\r\n\t\tlengthMenu: [[10,50,100,-1],[10,50,100,\"All\"]]\r\n\t});\r\n}\r\n\r\nfunction processIdentifier(process, data)\r\n{\r\n\tswitch(process)\r\n\t{\r\n\t\tcase 'approve_affiliate_campaign_request':\r\n\t\t\tapproveAffiliateApplyToRunRequest(data);\r\n\t\t\tbreak;\r\n\t\tcase 'reject_affiliate_campaign_request':\r\n\t\t\trejectAffiliateApplyToRunRequest(data);\r\n\t\t\tbreak;\r\n\t\tcase 'revert_affiliate_campaign_request':\r\n\t\t\trevertAffiliateApplyToRunRequest(data);\r\n\t\t\tbreak;\r\n        default:\r\n\t\t\talert('unknown process!');\r\n\t\t\tbreak;\r\n\t}\r\n}\r\n\r\nfunction approveAffiliateApplyToRunRequest(request_id) {\r\n\tvar pendingTable = $('#pendingAffiliateRequests-table').DataTable();\r\n\tpendingTable.row($('.approveRequestBtn[data-id=\"'+request_id+'\"]').parents('tr')).remove().draw();\r\n\tupdatedActiveTable = 1;\r\n\t$('#confirmationModal').modal('hide');\r\n}\r\n\r\nfunction rejectAffiliateApplyToRunRequest(request_id) {\r\n\tvar pendingTable = $('#pendingAffiliateRequests-table').DataTable();\r\n\tpendingTable.row($('.rejectRequestBtn[data-id=\"'+request_id+'\"]').parents('tr')).remove().draw();\r\n\tupdatedRejectTable = 1;\r\n\t$('#confirmationModal').modal('hide');\r\n}\r\n\r\nfunction revertAffiliateApplyToRunRequest(request_id) {\r\n\tconsole.log(request_id);\r\n\tvar rejectedTable = $('#rejectedAffiliateRequests-table').DataTable();\r\n\trejectedTable.row($('.revertRequestBtn[data-id=\"'+request_id+'\"]').parents('tr')).remove().draw();\r\n\tvar pendingTable = $('#pendingAffiliateRequests-table').DataTable();\r\n\tpendingTable.ajax.reload();\r\n\t$('#confirmationModal').modal('hide');\r\n}\r\n\r\n$(document).ready(function() {\r\n\r\n\t// var dataApplyToRunURL = $('#baseUrl').html() + '/apply_to_run';\r\n\tvar pendingTable = populateAffiliateRequestDataTable('#pendingAffiliateRequests-table', 2, 0);\r\n\tvar activeTable, rejectedTable, deactivatedTable;\r\n\tvar baseURL = $('#baseUrl').html();\r\n\r\n\t/* Open Active Tab */\r\n\t$('[href=\"#active-tab\"]').click(function(){\r\n\t\tvar activeTableName = '#activeAffiliateRequests-table';\r\n\t\tif ( ! $.fn.DataTable.isDataTable( activeTableName ) ) {\r\n\t\t\t$('#active-loading').hide();\r\n\t\t\t$('#active-data').show();\r\n\t\t  \tactiveTable = populateAffiliateRequestDataTable(activeTableName, 1, -1);\r\n\t\t}\r\n\r\n\t\tif(updatedActiveTable != 0) {\r\n\t\t\tconsole.log('Active');\r\n\t\t\tupdatedActiveTable = 0;\r\n\t\t\tactiveTable.ajax.reload();\r\n\t\t\t// activeTable.fnDraw();\r\n\t\t}\r\n\t});\r\n\r\n\t/* Open Rejected Tab */\r\n\t$('[href=\"#rejected-tab\"]').click(function(){\r\n\t\tvar rejectedTableName = '#rejectedAffiliateRequests-table';\r\n\t\tif ( ! $.fn.DataTable.isDataTable( rejectedTableName ) ) {\r\n\t\t\t$('#rejected-loading').hide();\r\n\t\t\t$('#rejected-data').show();\r\n\t\t  \trejectedTable = populateAffiliateRequestDataTable(rejectedTableName, 3, null);\r\n\t\t}\r\n\r\n\t\tif(updatedRejectTable != 0) {\r\n\t\t\tconsole.log('Reject');\r\n\t\t\tupdatedRejectTable = 0;\r\n\t\t\trejectedTable.ajax.reload();\r\n\t\t\t// activeTable.fnDraw();\r\n\t\t}\r\n\t});\r\n\r\n\t/* Open Deactivated Tab */\r\n\t$('[href=\"#deactivated-tab\"]').click(function(){\r\n\t\tvar deactivatedTableName = '#deactivatedAffiliateRequests-table';\r\n\t\tif ( ! $.fn.DataTable.isDataTable( deactivatedTableName ) ) {\r\n\t\t\t$('#deactivated-loading').hide();\r\n\t\t\t$('#deactivated-data').show();\r\n\t\t  \tdeactivatedTable = populateAffiliateRequestDataTable(deactivatedTableName, 0, -1);\r\n\t\t}else {\r\n\t\t\tconsole.log('Rejected');\r\n\t\t\t// rejectedTable.ajax.reload();\r\n\t\t\t// activeTable.fnDraw();\r\n\t\t\t// var column = pendingTable.column( 0 );\r\n\t\t\t// column.visible( ! column.visible() );\r\n\t\t}\r\n\t});\r\n\r\n\t/* Submit Confirmation Modal */\r\n\t$(document).on('submit','.confirmation-form',function(e) \r\n\t{\r\n\t\te.preventDefault();\r\n\t\tvar form = $(this);\r\n\t\tvar the_data = form.serialize();\r\n    \tvar url = form.attr('action');\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: 'POST',\r\n\t\t\tdata: the_data,\r\n\t\t\turl: url,\r\n\t\t\tsuccess: function(data)\r\n\t\t\t{\r\n\t\t\t\tconsole.log('Success');\r\n\t\t\t\tprocessIdentifier(form.data('process'), data);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t/* Close Confirmation Modal */\r\n\t$('#confirmationModal').on('hidden.bs.modal', function (e) {\r\n\t  $('#confirmationHeader').removeClass('success-modal-header primary-modal-header danger-modal-header');\r\n\t  $('#confirmationButton').removeClass('btn-success btn-danger');\r\n\t})\r\n\r\n\t/* Approve Pending Request Button */\r\n\t$(document).on('click','.approveRequestBtn',function() \r\n\t{\r\n\t\t// console.log($('#baseUrl').html())\r\n\t\tvar id = $(this).data('id');\r\n\t\tvar form = $('.confirmation-form');\r\n\t\tform.attr('action', baseURL+'/approve_affiliate_campaign_request');\r\n\t\tform.attr('data-process', 'approve_affiliate_campaign_request').data('process','approve_affiliate_campaign_request');\r\n\t\t$('#affiliate_campaign_request_id').val(id);\r\n\t\tvar description = \"You are about to approve <strong>\"+ $('#rqst-'+id+'-aff').html() +\"'s</strong> request to run <strong>\"+ $('#rqst-'+id+'-cmp').html() +\".</strong>\";\r\n\t\t$('#confirmation-description').html(description);\r\n\t\t$('#confirmationHeader').addClass('success-modal-header');\r\n\t\t$('#confirmationButton').addClass('btn-success');\r\n\t\t$('#confirmationModal').modal('show');\r\n\t});\r\n\r\n\t/* Reject Pending Request Button */\r\n\t$(document).on('click','.rejectRequestBtn',function() \r\n\t{\r\n\t\tvar id = $(this).data('id');\r\n\t\tvar form = $('.confirmation-form');\r\n\t\tform.attr('action', baseURL+'/reject_affiliate_campaign_request');\r\n\t\tform.attr('data-process', 'reject_affiliate_campaign_request').data('process','reject_affiliate_campaign_request');\r\n\t\t$('#affiliate_campaign_request_id').val(id);\r\n\t\tvar description = \"You are about to reject <strong>\"+ $('#rqst-'+id+'-aff').html() +\"'s</strong> request to run <strong>\"+ $('#rqst-'+id+'-cmp').html() +\".</strong>\";\r\n\t\t$('#confirmation-description').html(description);\r\n\t\t$('#confirmationHeader').addClass('danger-modal-header');\r\n\t\t$('#confirmationButton').addClass('btn-danger');\r\n\t\t$('#confirmationModal').modal('show');\r\n\t});\r\n\r\n\t/* Revert Rejected Request Button */\r\n\t$(document).on('click','.revertRequestBtn',function() \r\n\t{\r\n\t\t// console.log($('#baseUrl').html())\r\n\t\tvar id = $(this).data('id');\r\n\t\tvar form = $('.confirmation-form');\r\n\t\tform.attr('action', baseURL+'/revert_affiliate_campaign_request');\r\n\t\tform.attr('data-process', 'revert_affiliate_campaign_request').data('process','revert_affiliate_campaign_request');\r\n\t\t$('#affiliate_campaign_request_id').val(id);\r\n\t\tvar description = \"You are about to revert <strong>\"+ $('#rqst-'+id+'-aff').html() +\"'s</strong> request to run <strong>\"+ $('#rqst-'+id+'-cmp').html() +\"</strong> to pending.\";\r\n\t\t$('#confirmation-description').html(description);\r\n\t\t$('#confirmationHeader').addClass('danger-modal-header');\r\n\t\t$('#confirmationButton').addClass('btn-danger');\r\n\t\t$('#confirmationModal').modal('show');\r\n\t});\r\n\r\n\t\r\n});"]}