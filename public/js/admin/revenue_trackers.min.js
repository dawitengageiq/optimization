$(document).ready(function(){$("#timepicker").timepicker({minuteStep:5,showInputs:!1,disableFocus:!1}),$("#timepicker").timepicker().on("show.timepicker",function(e){$('a[data-action="incrementMinute"]').css("cursor","not-allowed").removeAttr("data-action"),$('a[data-action="decrementMinute"]').css("cursor","not-allowed").removeAttr("data-action")});var e=JSON.parse($("#campaign_names").val()),r=JSON.parse($("#campaign_statuses").val()),t=null;$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")}}),$(".search-revenueTracker-select").select2({placeholder:"Select the id or name of the affiliate.",minimumInputLength:1,dropdownParent:$("#TrkFormModal"),theme:"bootstrap",language:{inputTooShort:function(e){return"Please enter the id or name of the affiliate. (Enter 1 or more characters)"}},ajax:{url:$("#baseUrl").html()+"/search/select/activeRevenueTrackers",dataType:"json",type:"POST",data:function(e){var r={term:e.term};return r},processResults:function(e){return{results:$.map(e.items,function(e){return{text:e.name,id:e.id}})}}}});$(".search-affiliate-select").select2({placeholder:"Select the id or name of the affiliate.",minimumInputLength:1,dropdownParent:$("#TrkFormModal"),theme:"bootstrap",language:{inputTooShort:function(e){return"Please enter the id or name of the affiliate. (Enter 1 or more characters)"}},ajax:{url:$("#baseUrl").html()+"/search/select/activeAffiliates",dataType:"json",type:"POST",data:function(e){var r={term:e.term};return console.log(e),r},processResults:function(e){return console.log(e),{results:$.map(e.items,function(e){return{text:e.name,id:e.id}})}}}});$("#link").change(function(){var e=$(this).val(),r=e.indexOf("http://")>-1,t=e.indexOf("https://")>-1;r||t||(e="http://"+e),$(this).val(e)});var a=$("#baseUrl").html()+"/revenue_trackers";$("#tracker-table").DataTable({processing:!0,serverSide:!0,columns:[null,null,null,null,null,null,null,null,null,null,null,{orderable:!1}],columnDefs:[{width:"15%",targets:11}],order:[[4,"asc"]],ajax:{url:a,type:"post",error:function(){},dataSrc:function(e){return $("#downloadRevenuetracker").removeAttr("disabled"),e.data}},lengthMenu:[[25,50,100,1e3,2e3,3e3],[25,50,100,1e3,2e3,3e3]],sDom:'l<"revTrackerToolbar">frtip'}),$("div.revTrackerToolbar").html('<a id="downloadRevenuetracker" href="'+$("#baseUrl").html()+'/downloadRevenueTrackers" class="btn btn-primary" disabled><span class="glyphicon glyphicon-save" aria-hidden="true"></span></button>'),$("#addTrkBtn").click(function(){var e=$("#TrkFormModal"),r=$("#baseUrl").html()+"/add_revenue_tracker";e.find(".this_form").attr("action",r),e.find(".this_form").attr("data-process","add_revenue_tracker").data("process","add_revenue_tracker"),e.find(".this_form").attr("data-confirmation","").data("confirmation",""),e.find(".modal-title").html("Add Revenue Tracker"),e.find("#this_id").val(""),e.find("#affiliate").val("").trigger("change"),e.find("#revenue_tracker").val("").trigger("change"),$("#subid_breakdown").val(1),$("#currentSIBSetting-div").show(),$("#sib_s1").prop("checked",!0),$("#sib_s2").prop("checked",!0),$("#sib_s3").prop("checked",!0),$("#sib_s4").prop("checked",!0),$(".this_modal_submit").removeAttr("disabled"),e.modal("show")}),$(document).on("click",".editTracker",function(){var e=$("#TrkFormModal"),r=$(this).data("id"),t=$("#baseUrl").html()+"/edit_revenue_tracker",a=$.parseJSON($("#trk-"+r+"-details").val());console.log(a),e.find(".this_form").attr("action",t),e.find(".this_form").data("process","edit_revenue_tracker"),e.find(".this_form").attr("data-process","edit_revenue_tracker"),e.find(".this_form").data("confirmation","Are you sure you want to edit this revenue tracker?"),e.find(".this_form").attr("data-confirmation","Are you sure you want to edit this revenue tracker?"),e.find(".modal-title").html("Edit Revenue Tracker"),e.find("#this_id").val(r);var i="#trk-"+r+"-";$("#website").val(a.website);var n=$(i+"aff").data("affiliate"),o=$(i+"aff").html(),c=$("#affiliate");c.empty(),c.append('<option value="'+n+'">'+o+"</option>"),c.select2("data",{id:n,text:o},!0),c.trigger("change"),c.prop("disabled",!0),c.after('<input type="hidden" name="affiliate" value="'+n+'" id="dummyAffiliateId"/>'),$("#campaign").val(a.campaign_id),$("#offer").val(a.offer_id);var d=$(i+"rti").html(),l=$(i+"rti").data("revenue_tracker_name"),s=$("#revenue_tracker");s.empty(),s.append('<option value="'+d+'">'+l+"</option>"),s.select2("data",{id:d,text:l},!0),s.trigger("change"),$("#s1").val(a.s1),$("#s2").val(a.s2),$("#s3").val(a.s3),$("#s4").val(a.s4),$("#s5").val(a.s5),$("#link").val(a.tracking_link),$("#notes").val(a.note),$("#type").val(a.path_type),$("#crg_limit").val(a.crg_limit),$("#ext_limit").val(a.ext_limit),$("#lnk_limit").val(a.lnk_limit),$("#fire").val(a.fire_at),$("#pixel").val(a.pixel),$("#order_type").val(a.order_type),$("#pixel_header").val(a.pixel_header),$("#pixel_body").val(a.pixel_body),$("#pixel_footer").val(a.pixel_footer),$("#exit_page").val(a.exit_page_id),$("#subid_breakdown").val(a.subid_breakdown),$("#new_subid_breakdown_status").val(a.new_subid_breakdown_status),0==a.subid_breakdown?$("#currentSIBSetting-div").hide():$("#currentSIBSetting-div").show(),$("#sib_s1").prop("checked",1==a.sib_s1),$("#sib_s2").prop("checked",1==a.sib_s2),$("#sib_s3").prop("checked",1==a.sib_s3),$("#sib_s4").prop("checked",1==a.sib_s4),0==a.new_subid_breakdown_status||null==a.new_subid_breakdown_status?$("#newSIBSetting-div").hide():$("#newSIBSetting-div").show(),$("#nsib_s1").prop("checked",1==a.nsib_s1),$("#nsib_s2").prop("checked",1==a.nsib_s2),$("#nsib_s3").prop("checked",1==a.nsib_s3),$("#nsib_s4").prop("checked",1==a.nsib_s4),e.modal("show")}),$("#reorder").change(function(){console.log("reorder toggle: "+$(this).prop("checked")),$(this).prop("checked")?($(this).val(1),$("#mixed_coreg_campaign_order_form").find('#timepicker, input[name="mixed_coreg_recurrence"]').prop("disabled",!1)):($(this).val(0),$("#mixed_coreg_campaign_order_form").find('#timepicker, input[name="mixed_coreg_recurrence"]').prop("disabled",!0))}),$("#mixed_coreg_reorder").change(function(){console.log("reorder toggle: "+$(this).prop("checked")),$(this).prop("checked")?($(this).val(1),$('#timepicker, input[name="mixed_coreg_recurrence"]').prop("disabled",!1),$('[name="mixed_coreg_views"]').prop("disabled",!1)):($(this).val(0),$("#mixed_coreg_campaign_order_form").find('#timepicker, input[name="mixed_coreg_recurrence"]').prop("disabled",!0),$('[name="mixed_coreg_views"]').prop("disabled",!0))}),$(document).on("click",".deleteTracker",function(){var e=$(this),r=$(this).data("id"),t=$("#baseUrl").val()+"/delete_revenue_tracker",a=!0;a=confirm("Are you sure you want to delete revenue tracker id: "+$("#trk-"+r+"-rti").html()+"?"),a===!0&&$.ajax({type:"POST",data:{id:r},url:t,success:function(){var r=$("#tracker-table").DataTable();r.row(e.parents("tr")).remove().draw()}})}),$("#TrkFormModal").on("hide.bs.modal",function(e){var r=$(this).find(".this_form");$(".this_modal_submit").html("Save"),r.find(".this_field").each(function(){$(this).val("")}),r.find("#order_type").val(0),r.find("#subid_breakdown").val(0),r.find("#new_subid_breakdown_status").val(""),r.find("#this_id").val(""),r.find(".error").each(function(){$(this).removeClass("error"),$(this).removeClass("error_field"),$(this).removeClass("error_label")}),$("#affiliate").removeAttr("disabled"),$("#dummyAffiliateId").remove(),$(".this_error_wrapper").hide()}),$(document).on("click",".mixedCoregCampaignOrdering",function(){var t=$(this).data("id"),a=$(this).data("rt_id"),i=$("#mixedCoregCampaignOrderFormModal"),n=$("#mixed_coreg_campaign_order_form");n.find("#mixed_coreg_rev_tracker_id").val(t),n.find("#mixed_coreg_rev_tracker_display").val(t),n.find("#this_id").val(a),$.ajax({type:"POST",url:$("#baseUrl").html()+"/revenue_tracker_mixed_coreg_campaign_order/"+t,error:function(e){},success:function(t){var o=t.campaignOrder,c=t.reorderReferenceDate;$("#mixed_coreg_reference_date").val(c),$("#timepicker").timepicker("setTime",t.daily.daily_time),"daily"==t.daily.recurence?($("#recurrence_daily").prop("checked",!0),$("#recurrence_views").prop("checked",!1)):($("#recurrence_views").prop("checked",!0),$("#recurrence_daily").prop("checked",!1));var d=$(".mixedCoregCampaignOrderList");d.html("");var l=!0,s=$("#trk-"+a+"-mixed_coreg_order_by").val(),_=$("#trk-"+a+"-mixed_coreg_campaign_views").val(),p=$("#trk-"+a+"-mixed_coreg_campaign_limit").val();0==parseInt(p)&&(p=null),null!=o&&""!=o&&"[]"!=o||(o=$("#default_mixed_coreg_campaign_order").val(),l=!1,s=2,_=0,p=null),n.find("#mixed_coreg_order_by").val(s),n.find("#mixed_coreg_views").val(_),n.find("#mixed_coreg_limit").val(p);var m=$("#trk-"+a+"-mixed_coreg_order_status").val();1==m?n.find("#mixed_coreg_reorder").bootstrapToggle("on"):n.find("#mixed_coreg_reorder").bootstrapToggle("off"),console.log(o),o=JSON.parse(o),$.each(o,function(t,a){$("#mixedCoregCampaignOrderList").append('<li class="list-group-item" id="ct_'+t+"_id_"+a+'" data-campaign_id="'+a+'" >'+a+" - "+e[a]+' <span class="pull-right">'+r[a]+"</span></li>")}),$('input[name="mixed_coreg_campaign_order"]').val(JSON.stringify(o)),d.sortable({helper:function(e,r){return r.children().each(function(){$(this).width($(this).width())}),r},update:function(e,r){var t="[",a="#"+$(this).attr("id")+" li";$(a).each(function(){t+=$(this).data("campaign_id")+","}),t=t.slice(0,-1),t+="]",$('input[name="mixed_coreg_campaign_order"]').val(t)}}).disableSelection(),i.modal("show")}})}),$(document).on("click",".trackerCampaignType",function(){var a=$(this).data("id"),i=$(this).data("rt_id"),n=$("#CmpOrdrFormModal"),o=$("#campaign_order_form"),c=$.parseJSON($("#trk-"+i+"-details").html());o.find("#rev_tracker_id").val(a),o.find("#rev_tracker_display").val(a),o.find("#this_id").val(i),$.ajax({type:"POST",url:$("#baseUrl").html()+"/revenue_tracker_campaign_order/"+a,error:function(e){},success:function(a){console.log(a),$(".campOrderGrpList").html("");var i=a.campaignOrder,d=!0,l=c.order_by,s=c.views;null==i&&(i=JSON.parse($("#default_campaign_order").val()),d=!1,l=2,s=0),t=a.referenceDate,o.find("#order_by").val(l),o.find("#views").val(s);var _=c.order_status;1==_?o.find("#reorder").bootstrapToggle("on"):o.find("#reorder").bootstrapToggle("off"),o.find("#campaign_type_constants option").each(function(){var t=$(this).val();if("undefined"==typeof i[t])return!0;var a=i[t];d&&(a=JSON.parse(a)),$('input[name="campaign_type_order['+t+']"]').val(JSON.stringify(a)),$.each(a,function(a,i){$("#campTypeOrderList_"+t).append('<li class="list-group-item" id="ct_'+a+"_id_"+i+'" data-campaign_id="'+i+'" >'+i+" - "+e[i]+' <span class="pull-right">'+r[i]+"</span></li>")})}),o.find("#campaign_type_constants").trigger("change"),n.modal("show")}})}),$("#campaign_type_constants").change(function(){var e=$(this).val(),r="#campOrderContainer_"+e;$(".campaignOrderContainer").hide(),$(r).show(),null!=t?$("#reference_date").val(t[e]):$("#reference_date").val("")}),$(".campOrderGrpList").each(function(){var e="#"+$(this).attr("id"),r=$(e),t=$('input[name="campaign_type_order['+$(this).data("campaign_type")+']"]'),a=$(t);if(""==a.val()){var i="[";$(e+" li").each(function(){i+=$(this).data("campaign_id")+","}),i=i.slice(0,-1),""!=i&&(i+="]"),a.val(i)}r.sortable({helper:function(e,r){return r.children().each(function(){$(this).width($(this).width())}),r},update:function(e,r){var t="[",a="#"+$(this).attr("id")+" li",i='input[name="campaign_type_order['+$(this).data("campaign_type")+']"]';$(a).each(function(){t+=$(this).data("campaign_id")+","}),t=t.slice(0,-1),t+="]",$(i).val(t)}}).disableSelection()}),$("#CmpOrdrFormModal").on("hide.bs.modal",function(e){var r=$(this).find(".this_form");$(".this_modal_submit").html("Save"),$(".campOrderGrpList").html(""),$(".campOrderGrpList").html(""),r.find(".this_field").each(function(){$(this).val("")}),r.find("#this_id").val(""),r.find(".error").each(function(){$(this).removeClass("error"),$(this).removeClass("error_field"),$(this).removeClass("error_label")}),$(".this_error_wrapper").hide(),$("#reference_date").val(""),$("#campaign_type_constants").val(1).trigger("change"),t=null}),$("#exit_page_rev_tracker_selection").select2({placeholder:"Select the id of the Revenue Tracker.",minimumInputLength:1,theme:"bootstrap",language:{inputTooShort:function(e){return"Please enter the id of the Revenue Tracker. (Enter 1 or more characters)"}},ajax:{url:$("#baseUrl").html()+"/search/select/availableRevTrackersForExitPage",dataType:"json",type:"POST",data:function(e){var r={term:e.term,exit_page_id:$("#exit_page_selected").val(),selected:$("#exit_page_rev_tracker_selection").val()};return r},processResults:function(e){return{results:$.map(e.items,function(e){return{text:e.revenue_tracker_id,id:e.id}})}}}}),$(document).on("change","#exit_page_rev_tracker_selection",function(){$("#exit_page_rev_tracker_selection option:selected").length>0?($(".setExitPageBtn").removeAttr("disabled"),$("#remove_revenue_tracker_id_selections").show()):($(".setExitPageBtn").attr("disabled",!0),$("#remove_revenue_tracker_id_selections").hide())}),$(document).on("click","#remove_revenue_tracker_id_selections",function(){$("#exit_page_rev_tracker_selection").val(null).trigger("change")});var i=$("#exitPageTracker-table").DataTable({processing:!0,serverSide:!0,autoWidth:!1,columnDefs:[{orderable:!1,targets:[0]}],order:[[1,"asc"]],ajax:{url:$("#baseUrl").html()+"/exitPageRevTrackers",type:"post",data:function(e){e.exit_page_id=$("#exit_page_selected").val()},dataSrc:function(e){return $("#selectAllEPRT").prop("checked",!1),$("#removeExitPageRevTrackerBtn").attr("disabled",!0),e.data},error:function(e){console.log(e)}},lengthMenu:[[25,50,100,1e3,2e3,3e3],[25,50,100,1e3,2e3,3e3]],sDom:'l<"setExitPageToolbar">frtip'});$("div.setExitPageToolbar").html('<input id="removeExitPageRevTrackerBtn" class="btn btn-primary pull-right btn-xs" type="submit" value="Set to Default">'),$(document).on("click","#setExitPageBtn",function(){$("#setExitPageModal").modal("show")}),$(document).on("change","#exit_page_selected",function(){$("#exit_page_rev_tracker_selection").val(null).trigger("change"),i.clear().search(""),i.ajax.reload()}),$(document).on("change",".eprt-checkbox",function(){var e=$(".eprt-checkbox:checked").length,r=$("#exit_page_selected").val();e>0&&""!=r?$("#removeExitPageRevTrackerBtn").removeAttr("disabled"):$("#removeExitPageRevTrackerBtn").attr("disabled",!0),e==$(".eprt-checkbox").length?$("#selectAllEPRT").prop("checked",!0):$("#selectAllEPRT").prop("checked",!1)}),$("#selectAllEPRT").on("change",function(e){$(".eprt-checkbox").prop("checked",$(this).prop("checked")).trigger("change")}),$("#setExitPageModal").on("hide.bs.modal",function(e){$("#exit_page_rev_tracker_selection").val(null).trigger("change"),$("#exit_page_selected").val(null).trigger("change")}),$(document).on("click","#new_subid_breakdown_status",function(){var e=$(this).val();1==e?$("#newSIBSetting-div").show():($("#newSIBSetting-div").hide(),$("#nsib_s1").prop("checked",!1),$("#nsib_s2").prop("checked",!1),$("#nsib_s3").prop("checked",!1),$("#nsib_s4").prop("checked",!1))})});
//# sourceMappingURL=revenue_trackers.min.js.map
