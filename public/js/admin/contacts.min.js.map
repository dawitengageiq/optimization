{"version":3,"sources":["contacts.js"],"names":["inactiveAffiliates","inactiveAdvertisers","$","document","ready","containsObject","obj","list","i","length","value","select2","theme","contactsTable","advertiserID","data","affiliateID","dataContactsURL","html","extraData","undefined","awesome_advertiser_id","awesome_affiliate_id","DataTable","processing","serverSide","columns","orderable","ajax","url","type","error","lengthMenu","click","this_modal","formActionURL","find","attr","val","affiliateIDSelect","advertiserIDSelect","prop","trigger","show","n","inactiveAffiliate","remove","inactiveAdvertiser","modal","hide","change","affiliateSelect","this","is","advertiserSelect","on","confirm","id","success","delete_status","table","row","draw","alert","message","this_contact","full_name","trim","nameArray","split","title","first_name","middle_name","last_name","gender","position","email","address","mobile_number","phone_number","instant_messaging","active","affiliateExists","affiliate_id","append","text","name","console","log","push","advertiserExists","advertiser_id"],"mappings":"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","file":"contacts.min.js","sourcesContent":["/**\r\n * Created by magbanua-ariel on 11/09/2015.\r\n */\r\n\r\nvar inactiveAffiliates = [];\r\nvar inactiveAdvertisers = [];\r\n\r\n$(document).ready(function()\r\n{\r\n    /*\r\n    $('.table-datatable').DataTable({\r\n        responsive: true,\r\n        \"order\": [[ 0, \"desc\" ]],\r\n        lengthMenu: [[1000,2000,3000,4000,5000,-1],[1000,2000,3000,4000,5000,\"All\"]]\r\n    });\r\n    */\r\n\r\n    //select2 implementation for affiliate and advertiser select tags\r\n    $('#affiliate_id').select2({\r\n        theme: 'bootstrap'\r\n    });\r\n    $('#advertiser_id').select2({\r\n        theme: 'bootstrap'\r\n    });\r\n\r\n    var contactsTable = $('#contacts-table');\r\n    var advertiserID = contactsTable.data('advertiser');\r\n    var affiliateID = contactsTable.data('affiliate');\r\n    var dataContactsURL = $('#baseUrl').html() + '/contacts';\r\n    var extraData = {};\r\n\r\n    if(advertiserID!=undefined)\r\n    {\r\n        extraData = {\r\n            'awesome_advertiser_id' : advertiserID\r\n        }\r\n    }\r\n    else if(affiliateID!=undefined)\r\n    {\r\n        extraData = {\r\n            'awesome_affiliate_id' : affiliateID\r\n        }\r\n    }\r\n\r\n    contactsTable.DataTable({\r\n        'processing': true,\r\n        'serverSide': true,\r\n        'columns': [\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            { 'orderable': false }\r\n        ],\r\n        'ajax':{\r\n            'url' : dataContactsURL, // json datasource\r\n            'type' : 'post',  // method  , by default get\r\n            'data' : extraData,\r\n            error: function(){  // error handling\r\n\r\n            }\r\n        },\r\n        lengthMenu: [[25,50,100,1000,2000,3000],[25,50,100,1000,2000,3000]]\r\n    });\r\n\r\n    /***\r\n     * onclick listener for add contact\r\n     */\r\n    $('#add_contact_button').click(function()\r\n    {\r\n        var this_modal = $('#contacts_form_modal');\r\n        var formActionURL = $('#baseUrl').html() + '/admin/contact/store';\r\n\r\n        this_modal.find('.this_form').attr('action',formActionURL);\r\n        this_modal.find('.this_form').attr('data-process', 'add_contact');\r\n        this_modal.find('.this_form').data('confirmation','');\r\n        this_modal.find('.this_form').attr('data-confirmation', '');\r\n        this_modal.find('.modal-title').html('Add Contact');\r\n\r\n        //reset all needed fields in the modal\r\n        $('.this_field').val('');\r\n        $('#title').val('Mr.');\r\n        $('#gender').val('M');\r\n\r\n        var affiliateIDSelect = $('#affiliate_id');\r\n        var advertiserIDSelect = $('#advertiser_id');\r\n\r\n        $('#affiliate_checkbox').prop('checked',false);\r\n        affiliateIDSelect.prop('disabled',true);\r\n        $('#advertiser_checkbox').prop('checked',false);\r\n        advertiserIDSelect.prop('disabled',true);\r\n\r\n        affiliateIDSelect.val($(\"#affiliate_id option:first\").val()).trigger('change');\r\n        advertiserIDSelect.val($(\"#advertiser_id option:first\").val()).trigger('change');\r\n\r\n        $('.password-fields-container').show();\r\n        $('.password-fields').prop('required',true);\r\n\r\n        //remove the inactive affiliates that was added during editing\r\n        for(var n=0;n<inactiveAffiliates.length;n++)\r\n        {\r\n            var inactiveAffiliate = inactiveAffiliates[n];\r\n            $(\"#affiliate_id option[value='\"+inactiveAffiliate.value+\"']\").remove();\r\n        }\r\n\r\n        //remove the inactive advertisers that was added during editing\r\n        for(var n=0;n<inactiveAdvertisers.length;n++)\r\n        {\r\n            var inactiveAdvertiser = inactiveAdvertisers[n];\r\n            $(\"#advertiser_id option[value='\"+inactiveAdvertiser.value+\"']\").remove();\r\n        }\r\n\r\n        this_modal.modal('show');\r\n\r\n        //hide the error block\r\n        $('.this_error_wrapper').hide();\r\n    });\r\n\r\n    $('#affiliate_checkbox').change( function()\r\n    {\r\n        var affiliateSelect = $('#affiliate_id');\r\n\r\n        if ($(this).is(':checked'))\r\n        {\r\n            affiliateSelect.prop('disabled',false);\r\n        }\r\n        else\r\n        {\r\n            affiliateSelect.prop('disabled',true);\r\n        }\r\n    });\r\n\r\n    $('#advertiser_checkbox').change( function()\r\n    {\r\n        var advertiserSelect = $('#advertiser_id');\r\n\r\n        if ($(this).is(':checked'))\r\n        {\r\n            advertiserSelect.prop('disabled',false);\r\n        }\r\n        else\r\n        {\r\n            advertiserSelect.prop('disabled',true);\r\n        }\r\n    });\r\n\r\n    /***\r\n     * onclick listener for deleting affiliate\r\n     */\r\n    $(document).on('click','.delete-contact',function()\r\n    {\r\n        if(!confirm('Are you sure you want to delete this contact?'))\r\n        {\r\n            return;\r\n        }\r\n\r\n        var id = $(this).data('id');\r\n        var url = $('#baseUrl').val() + '/admin/contact/delete/'+id;\r\n\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: url,\r\n            success: function(data)\r\n            {\r\n                if(data.delete_status)\r\n                {\r\n                    var table = $('#contacts-table').DataTable();\r\n                    table.row($('#row-contact-'+id)).remove();\r\n                    table.draw();\r\n                }\r\n                else\r\n                {\r\n                    alert(data.message);\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    function containsObject(obj,list){\r\n\r\n        for (var i = 0; i < list.length; i++) {\r\n            if (list[i].value === obj.value) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /***\r\n     * onclick listener for editing contact\r\n     */\r\n    $(document).on('click','.edit-contact',function()\r\n    {\r\n        var this_modal = $('#contacts_form_modal');\r\n        var id = $(this).data('id');\r\n        var formActionURL = $('#baseUrl').html() + '/admin/contact/update/'+id;\r\n\r\n        this_modal.find('.this_form').attr('action',formActionURL);\r\n        this_modal.find('.this_form').data('process','edit_contact');\r\n        this_modal.find('.this_form').attr('data-process', 'edit_contact');\r\n        this_modal.find('.this_form').data('confirmation','Are you sure you want to update this contact?');\r\n        this_modal.find('.this_form').attr('data-confirmation', 'Are you sure you want to update this contact?');\r\n        this_modal.find('.modal-title').html('Edit Contact');\r\n        this_modal.find('#id').val(id);\r\n\r\n        var this_contact = '#contact-'+id+'-';\r\n        //var tableRow = $('#row-contact-'+id);\r\n        //var url = tableRow.data('url');\r\n\r\n        //fill all the fields\r\n        var affiliateID = $(this_contact+'affiliate_id').val();\r\n        var advertiserID = $(this_contact+'advertiser_id').val();\r\n        var full_name = $(this_contact+'full_name').html().trim();\r\n        var nameArray = full_name.split(' ');\r\n        var title = nameArray[0];\r\n        var first_name = nameArray[1];\r\n        var middle_name = nameArray[2];\r\n        var last_name = nameArray[3];\r\n        var gender = $(this_contact+'gender').val();\r\n        var position = $(this_contact+'position').html();\r\n        var email = $(this_contact+'email').html();\r\n        var address = $(this_contact+'address').val();\r\n        var mobile_number = $(this_contact+'mobile_number').html();\r\n        var phone_number = $(this_contact+'phone_number').html();\r\n        var instant_messaging = $(this_contact+'instant_messaging').val();\r\n\r\n        $('#title').val(title);\r\n        $('#first_name').val(first_name);\r\n        $('#middle_name').val(middle_name);\r\n        $('#last_name').val(last_name);\r\n        $('#gender').val(gender);\r\n        $('#position').val(position);\r\n        $('#address').val(address);\r\n        $('#email').val(email);\r\n        $('#mobile_number').val(mobile_number);\r\n        $('#phone_number').val(phone_number);\r\n        $('#instant_messaging').val(instant_messaging);\r\n\r\n        var affiliateSelect = $('#affiliate_id');\r\n        var advertiserSelect = $('#advertiser_id');\r\n\r\n        affiliateSelect.val($(\"#affiliate_id option:first\").val()).trigger('change');\r\n        advertiserSelect.val($(\"#advertiser_id option:first\").val()).trigger('change');\r\n\r\n        if(affiliateID!=='')\r\n        {\r\n            //check if affiliate is inactive. If inactive just include it in the selection list\r\n            var url = $('#baseUrl').val() + '/affiliates/'+affiliateID+'/status';\r\n\r\n            $.ajax({\r\n                type: 'POST',\r\n                url: url,\r\n                success: function(data)\r\n                {\r\n                    if(!data.active)\r\n                    {\r\n                        var affiliateExists = $(\"#affiliate_id option[value='\"+data.affiliate_id+\"']\").length > 0;\r\n\r\n                        $('#affiliate_checkbox').prop('checked',true);\r\n\r\n                        if(!affiliateExists)\r\n                        {\r\n                            //insert it in the current pool of options\r\n                            affiliateSelect.append($('<option>',{\r\n                                value: data.affiliate_id,\r\n                                text: data.name\r\n                            }));\r\n\r\n                            affiliateSelect.val(affiliateID).trigger('change');\r\n                            affiliateSelect.prop('disabled',false);\r\n                            console.log(data.affiliate_id+\" was added!\");\r\n                        }\r\n\r\n                        var inactiveAffiliate = {\r\n                            value: data.affiliate_id,\r\n                            text: data.name\r\n                        };\r\n\r\n                        if(!containsObject(inactiveAffiliate,inactiveAffiliates)){\r\n                            inactiveAffiliates.push(inactiveAffiliate);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            $('#affiliate_checkbox').prop('checked',true);\r\n            affiliateSelect.val(affiliateID).trigger('change');\r\n            affiliateSelect.prop('disabled',false);\r\n        }\r\n        else\r\n        {\r\n            $('#affiliate_checkbox').prop('checked',false);\r\n            affiliateSelect.prop('disabled',true);\r\n        }\r\n\r\n        if(advertiserID!=='')\r\n        {\r\n            //check if advertiser is inactive. If inactive just include it in the selection list\r\n            var url = $('#baseUrl').val() + '/advertisers/'+advertiserID+'/status';\r\n\r\n            $.ajax({\r\n                type: 'POST',\r\n                url: url,\r\n                success: function(data)\r\n                {\r\n                    if(!data.active)\r\n                    {\r\n                        var advertiserExists = $(\"#advertiser_id option[value='\"+data.advertiser_id+\"']\").length > 0;\r\n\r\n                        $('#advertiser_checkbox').prop('checked',true);\r\n\r\n                        if(!advertiserExists)\r\n                        {\r\n                            //insert it in the current pool of options\r\n                            advertiserSelect.append($('<option>',{\r\n                                value: data.advertiser_id,\r\n                                text: data.name\r\n                            }));\r\n\r\n                            advertiserSelect.val(advertiserID).trigger('change');\r\n                            advertiserSelect.prop('disabled',false);\r\n                            console.log(data.advertiser_id+\" was added!\");\r\n                        }\r\n\r\n                        var inactiveAdvertiser = {\r\n                            value: data.advertiser_id,\r\n                            text: data.name\r\n                        };\r\n\r\n                        if(!containsObject(inactiveAdvertiser,inactiveAdvertisers)){\r\n                            inactiveAdvertisers.push(inactiveAdvertiser);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            $('#advertiser_checkbox').prop('checked',true);\r\n            advertiserSelect.val(advertiserID).trigger('change');\r\n            advertiserSelect.prop('disabled',false);\r\n        }\r\n        else\r\n        {\r\n            $('#advertiser_checkbox').prop('checked',false);\r\n            advertiserSelect.prop('disabled',true);\r\n        }\r\n\r\n        $('.password-fields-container').hide();\r\n        $('.password-fields').prop('required',false);\r\n\r\n        //hide the error block\r\n        $('.this_error_wrapper').hide();\r\n\r\n        this_modal.modal('show');\r\n    });\r\n});\r\n"]}