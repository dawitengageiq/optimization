{"version":3,"sources":["advertisers.js"],"names":["getAvailableUsers","id","callback","the_url","$","val","ajax","type","data","url","success","document","ready","select2","theme","dropdownParent","change","inputURL","this","hasHTTP","indexOf","hasHTTPs","dataAdvertisersURL","html","DataTable","processing","serverSide","columns","orderable","order","error","lengthMenu","click","this_modal","formActionURL","hide","find","attr","prop","trigger","modal","remove","append","each","key","value","on","show","this_adv","currentCity","currentZip","console","log","this_advertiser","confirmation","confirm","table","row","parents","draw","event","form","removeClass","collapse","fadeIn","e","getCitiesByState","fadeOut"],"mappings":"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","file":"advertisers.min.js","sourcesContent":["/***\r\n * Get all unassigned or available users\r\n *\r\n * @param id\r\n * @param callback\r\n */\r\nfunction getAvailableUsers(id,callback)\r\n{\r\n\tvar the_url = $('#baseUrl').val() + '/get_available_users_as_advertiser';\r\n\t$.ajax({\r\n\t\ttype: 'POST',\r\n\t\tdata: {\r\n\t\t\t'id':id\r\n\t\t},\r\n\t\turl: the_url,\r\n\t\tsuccess: function(data){\r\n\t\t\tcallback(data);\r\n\t\t}\r\n\t});\r\n\r\n}\r\n\r\n$(document).ready(function()\r\n{\r\n\t$('.search-select').select2({\r\n\t\ttheme: 'bootstrap',\r\n\t\tdropdownParent: $(\"#AdvFormModal\")\r\n\t});\r\n\r\n\t$('#website_url').change(function()\r\n\t{\r\n\t\t//get the text value\r\n\t\tvar inputURL = $(this).val();\r\n\r\n\t\t//check if text has http:// or https://\r\n\t\tvar hasHTTP = inputURL.indexOf('http://') > -1;\r\n\t\tvar hasHTTPs = inputURL.indexOf('https://') > -1;\r\n\r\n\t\tif(!hasHTTP && !hasHTTPs)\r\n\t\t{\r\n\t\t\tinputURL = 'http://'+inputURL;\r\n\t\t}\r\n\r\n\t\t$(this).val(inputURL);\r\n\r\n\t});\r\n\r\n\tvar dataAdvertisersURL = $('#baseUrl').html() + '/advertisers';\r\n\t$('#advertiser-table').DataTable({\r\n\t\t'processing': true,\r\n\t\t'serverSide': true,\r\n\t\t\"columns\": [\r\n\t\t\tnull,\r\n\t\t\tnull,\r\n\t\t\tnull,\r\n\t\t\t{ \"orderable\": false },\r\n\t\t\tnull,\r\n\t\t\t{ \"orderable\": false }\r\n\t\t],\r\n\t\t\"order\": [[ 0, \"desc\" ]],\r\n\t\t'ajax':{\r\n\t\t\turl: dataAdvertisersURL, // json datasource\r\n\t\t\ttype: 'post',  // method  , by default get\r\n\t\t\terror: function(){  // error handling\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tlengthMenu: [[25,50,100,1000,2000,3000],[25,50,100,1000,2000,3000]]\r\n\t});\r\n\r\n\t$('#addAdvBtn').click(function()\r\n\t{\r\n\r\n        var this_modal = $('#AdvFormModal');\r\n        var formActionURL = $('#baseUrl').html() + '/admin/advertiser/store';\r\n\r\n\t\t$('#tab-with-history').hide();\r\n\r\n        this_modal.find('.this_form').attr('action',formActionURL);\r\n\t\tthis_modal.find('.this_form').data('process','add_advertiser');\r\n        this_modal.find('.this_form').attr('data-process', 'add_advertiser');\r\n\t\tthis_modal.find('.this_form').data('confirmation','');\r\n        this_modal.find('.this_form').attr('data-confirmation', '');\r\n        this_modal.find('.modal-title').html('Add Advertiser');\r\n\r\n        //clean all objects inside the form\r\n        //$('.this_field').val(''); //clear all fields that has this_field class\r\n        $('#adv_form input:text').val(''); //Clear all text field within the form\r\n\t\t$('#adv_form textarea').val(''); //Clear all text area fields within the form\r\n        $('#adv_form select').prop('selectedIndex',0); //clear all value selected in all select list\r\n\r\n\t\t$('#state').val('').trigger('change');\r\n\r\n        //show the form\r\n        $('#AdvFormModal').modal('show');\r\n\r\n\t\t//reset userlist to only display the available users that can be set as advertiser\r\n\t\tgetAvailableUsers(0,function(data) {\r\n\t\t\t//console.log(data);\r\n\t\t\t$('#id option').remove();\r\n\t\t\t$('#id').append('<option value=\"\"> </option>');\r\n\t\t\t$.each(data,function(key, value)\r\n\t\t\t{\r\n\t\t\t    $('#id').append('<option value=\"' + key + '\">' + value + '</option>');\r\n\t\t\t});\r\n\t\t})\r\n\r\n        //hide the error block\r\n        $('.this_error_wrapper').hide();\r\n\r\n\t});\r\n\r\n\t$(document).on('click','.editAdvertiser',function()\r\n\t{\r\n\t\tvar this_modal = $('#AdvFormModal');\r\n\t\tvar id = $(this).data('id');\r\n\t\tvar url = $('#baseUrl').html() + '/admin/advertiser/update/'+id;\r\n\r\n\t\t$('#tab-with-history').show();\r\n\r\n\t\tthis_modal.find('.this_form').attr('action',url);\r\n\t\tthis_modal.find('.this_form').data('process','edit_advertiser');\r\n\t\tthis_modal.find('.this_form').attr('data-process', 'edit_advertiser');\r\n\t\tthis_modal.find('.this_form').data('confirmation','Are you sure you want to edit this attribute?');\r\n\t\tthis_modal.find('.this_form').attr('data-confirmation', '')\r\n\t\tthis_modal.find('.modal-title').html('Edit Advertiser');\r\n\t\tthis_modal.find('#this_id').val(id);\r\n\t\tthis_modal.find('.table-history #reference_id').val(id);\r\n\r\n\t\tvar this_adv = '#adv-' + id + '-';\r\n\r\n\t\t$('#company').val( $(this_adv+'comp').html() );\r\n\t\t$('#website_url').val( $(this_adv+'web').html() );\r\n\t\t$('#phone').val( $(this_adv+'phn').html() );\r\n\t\t$('#address').val( $(this_adv+'add').html() );\r\n\t\t$('.state_zip_wrapper').show();\r\n\r\n        var currentCity = $(this_adv+'cty').html();\r\n        var currentZip = $(this_adv+'zip').html();\r\n\r\n        $('#city').data('current_city',currentCity);\r\n        $('#state').val($(this_adv+'ste').html()).trigger('change');\r\n        $('#zip').val(currentZip);\r\n\t\t//$('#zip').val( $(this_adv+'zip').html() );\r\n\r\n        console.log(currentCity);\r\n        console.log(currentZip);\r\n\r\n\t\t/*\r\n\t\tgetAvailableUsers($(this_adv+'user').data('id'),function(data) {\r\n\t\t\t$('#id option').remove();\r\n\t\t\t$('#id').append('<option value=\"\"> </option>');\r\n\t\t\t$.each(data,function(key, value)\r\n\t\t\t{\r\n\t\t\t    $('#id').append('<option value=\"' + key + '\">' + value + '</option>');\r\n\t\t\t});\r\n\t\t\t$('#id').val( $(this_adv+'user').data('id') );\r\n\t\t});\r\n\t\t*/\r\n        /*\r\n\t\tgetCitiesByState($('#state :selected').html(), function(data)\r\n\t\t{\r\n\t\t\t$('#city option').remove();\r\n\t\t\t$('#city').attr('required','true');\r\n\t\t\t$('#zip').attr('required','true');\r\n\t\t\t$('#city').append('<option value=></option>');\r\n\r\n\t\t\t$.each(data,function(key, value)\r\n\t\t\t{\r\n\t\t\t    $('#city').append('<option value=\"' + value + '\">' + value + '</option>');\r\n\t\t\t});\r\n\r\n\t\t\t$('.state_zip_wrapper').show();\r\n\t\t\t$('#address').attr('rows',2);\r\n\r\n\t\t\t$('#city').val($(this_adv+'cty').html());\r\n\t\t\t$('#zip').val($(this_adv+'zip').html());\r\n\t\t});\r\n        */\r\n\t\t$('#description').val($(this_adv+'desc').val());\r\n\t\t$('input[name=\"status\"][value=\"'+$(this_adv+'stat').data('status')+'\"]').prop('checked', true);\r\n\t\tthis_modal.modal('show');\r\n\t});\r\n\r\n\r\n\t$(document).on('click','.deleteAdvertiser',function()\r\n\t{\r\n\t\tvar this_advertiser = $(this);\r\n\t\tvar id = this_advertiser.data('id');\r\n\t\tvar the_url = $('#baseUrl').val() + '/admin/advertiser/destroy';\r\n\t\tvar confirmation = true;\r\n\r\n\t\tconfirmation = confirm('Are you sure you want to delete '+ $('#adv-'+id+'-comp').html() + '?');\r\n\r\n\t\tif(confirmation === true)\r\n\t\t{\r\n\t\t\t$.ajax({\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\t'id': id\r\n\t\t\t\t},\r\n\t\t\t\turl: the_url,\r\n\t\t\t\tsuccess: function(){\r\n\t\t\t\t\tvar table = $('#advertiser-table').DataTable();\r\n\t\t\t\t\ttable.row(this_advertiser.parents('tr')).remove().draw();\r\n\t\t\t\t\t//$('#adv-'+id+'-comp').parent().fadeOut();\r\n\t\t\t\t\t//$('#adv-'+id+'-comp').parent().remove();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$('#AdvFormModal').on('hide.bs.modal', function (event)\r\n\t{\r\n\t  var form = $(this).find('.this_form');\r\n\t  form.find('.this_field').each(function()\r\n\t  {\r\n\t  \tif($(this).attr('name') == 'status') {\r\n\t  \t\t$('input[name=\"status\"][value=\"1\"]').prop('checked', true);\r\n\t  \t}else {\r\n\t  \t\t$(this).val('');\r\n\t  \t}\r\n\t  });\r\n\r\n\t  form.find('.error').each(function(){\r\n\t\t\t$(this).removeClass('error');\r\n\t\t\t$(this).removeClass('error_field');\r\n\t\t\t$(this).removeClass('error_label');\r\n\t\t});\r\n\t  $('.state_zip_wrapper').hide();\r\n\t  $('.this_error_wrapper').hide();\r\n\t})\r\n\r\n\t$('#close-AddAffCol').click(function()\r\n\t{\r\n\t\t$('#AffFormCol').collapse('hide');\r\n\t\t$('.this_field').val('');\r\n\t\t$('#addAffColBtn').fadeIn( \"slow\");\r\n\t});\r\n\r\n\t$(document).on('change','.state_select',function(e)\r\n\t{\r\n\t\t//$('#city').val('');\r\n\t\t//$('#zip').val('');\r\n\r\n\t\tif($(this).val() != '')\r\n\t\t{\r\n            //placeholder while ajax is processing cities to be added\r\n            $('#city option').remove();\r\n            $('#city').append('<option value=>Processing cities for the state...</option>');\r\n\r\n\t\t\tgetCitiesByState($('#state option:selected').html(), function(data)\r\n            {\r\n\t\t\t\t$('#city option').remove();\r\n\r\n\t\t\t\t$('#city').attr('required','true');\r\n\t\t\t\t$('#zip').attr('required','true');\r\n\r\n\t\t\t\t$('#city').append('<option value=></option>');\r\n\r\n\t\t\t\t$.each(data,function(key, value)\r\n\t\t\t\t{\r\n\t\t\t\t    $('#city').append('<option value=\"' + value + '\">' + value + '</option>');\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$('.state_zip_wrapper').fadeIn('slow');\r\n\t\t\t\t$('#address').attr('rows',4);\r\n\r\n                //set if there is pre defined city\r\n                var currentCity = $('#city').data('current_city');\r\n                $('#city').val(currentCity).trigger('change');\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t$('#city').attr('required','false');\r\n\t\t\t$('#zip').attr('required','false');\r\n\t\t\t$('.state_zip_wrapper').fadeOut('fast');\r\n\t\t\t$('#address').attr('rows',1);\r\n\t\t}\r\n\t});\r\n\r\n\r\n\t$('#AffFormModal').on('hide.bs.modal', function (event)\r\n\t{\r\n\t    var form = $(this).find('.this_form');\r\n\r\n\t    form.find('.this_field').each(function()\r\n\t    {\r\n\t  \t    if($(this).attr('name') == 'status')\r\n            {\r\n\t  \t\t    $('input[name=\"status\"][value=\"1\"]').prop('checked', true);\r\n\t  \t    }\r\n            else\r\n            {\r\n\t  \t\t    $(this).val('');\r\n\t  \t    }\r\n\t    });\r\n\r\n\t    form.find('.error').each(function(){\r\n\t\t\t$(this).removeClass('error');\r\n\t\t\t$(this).removeClass('error_field');\r\n\t\t\t$(this).removeClass('error_label');\r\n\t\t});\r\n\r\n\t    $('.state_zip_wrapper').hide();\r\n\t    $('.this_error_wrapper').hide();\r\n\t});\r\n});\r\n"]}