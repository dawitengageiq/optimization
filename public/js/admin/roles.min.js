$(document).ready(function(){var e=$("#baseUrl").val()+"/admin/roles";$("#roles-table").DataTable({processing:!0,serverSide:!0,columns:[null,null,null,{orderable:!1}],ajax:{url:e,type:"get",error:function(){}},lengthMenu:[[25,50,100,1e3,2e3,3e3],[25,50,100,1e3,2e3,3e3]]}),$("#addRole").click(function(){var e=$("#roleModal");e.find(".permission-input-text").val(""),e.find(".permission-input-checkbox").removeAttr("checked"),e.find(".modal-title").html("Add Role"),$(".sub-section-permissions").css("display","none"),$(".this_error_wrapper").hide(),$("#updateRole").hide(),$("#saveRole").show(),e.modal("show")}),$("#updateRole").click(function(){var e=$("#roleModal"),s=e.find("#roleID").val(),i=e.find("#roleName").val(),a=e.find("#description").val(),r=i.length,o="";if(0==r){$(".this_error_wrapper").show();var n=$(".this_errors");return n.empty(),o="<ul>",o+='<li><span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> Role name is empty!</li>',o+="</ul>",n.append(o),n.show(),void console.log(o)}var c=[];$("input:checkbox.permission-input-checkbox").each(function(){var e=$(this).attr("id"),s=this.checked,i=$(this).data("action_id"),a={action_id:i,code:e,value:s};c.push(a)});var t=$("#baseUrl").val()+"roles/"+s+"/update",l=t+"?name="+encodeURIComponent(i)+"&description="+encodeURIComponent(a)+"&permissions="+encodeURIComponent(JSON.stringify(c));$.ajax({type:"GET",url:l,success:function(s){s.success&&(alert(s.message),console.log(s.role),$("#roles-"+s.role.id+"-name").html(s.role.name),$("#roles-"+s.role.id+"-description").html(s.role.description),e.modal("hide"))},error:function(s,i,a){alert(a),e.modal("hide")}})}),$("#saveRole").click(function(){var e=$("#roleModal"),s=e.find("#roleName").val(),i=e.find("#description").val(),a=s.length,r="";if(0==a){$(".this_error_wrapper").show();var o=$(".this_errors");return o.empty(),r="<ul>",r+='<li><span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> Role name is empty!</li>',r+="</ul>",o.append(r),o.show(),void console.log(r)}var n=[];$("input:checkbox.permission-input-checkbox").each(function(){var e=$(this).attr("id"),s=this.checked,i={code:e,value:s};n.push(i)});var c=$("#baseUrl").val()+"roles/save",t=c+"?name="+encodeURIComponent(s)+"&description="+encodeURIComponent(i)+"&permissions="+encodeURIComponent(JSON.stringify(n));$.ajax({type:"GET",url:t,success:function(s){if(s.success){alert(s.message);var i='<button class="editRole btn btn-default" data-id="'+s.role.id+'"><span class="glyphicon glyphicon-pencil"></span></button>';i+='<button class="deleteRole btn btn-default" data-id="'+s.role.id+'"><span class="glyphicon glyphicon-trash"></span></button>';var a=$("#roles-table").DataTable();a.row.add([s.role.id,s.role.name,s.role.description,i]).draw(),e.modal("hide")}},error:function(s,i,a){alert(a),e.modal("hide")}})}),$(".main-permission").change(function(){var e=$(this).attr("id");switch(e){case"access_contacts":this.checked?$("#contactPermissions").show():$("#contactPermissions").hide();break;case"access_affiliates":this.checked?$("#affiliatesPermissions").show():$("#affiliatesPermissions").hide();break;case"access_campaigns":this.checked?($("#campaignPermissions").show(),$("#campaignInfoPermissions").show()):($("#campaignPermissions").hide(),$("#campaignInfoPermissions").hide());break;case"access_advertisers":this.checked?$("#advertisersPermissions").show():$("#advertisersPermissions").hide();break;case"access_filter_types":this.checked?$("#filterTypesPermissions").show():$("#filterTypesPermissions").hide();break;case"access_revenue_trackers":this.checked?$("#revenueTrackersPermissions").show():$("#revenueTrackersPermissions").hide();break;case"access_gallery":this.checked?$("#galleryPermissions").show():$("#galleryPermissions").hide();break;case"access_categories":this.checked?$("#categoriesPermissions").show():$("#categoriesPermissions").hide()}})}),$(document).on("click",".editRole",function(){var e=$(this),s=e.data("id");$("#roleID").val(s);var i=$("#roleModal");i.find(".permission-input-text").val(""),i.find(".permission-input-checkbox").removeAttr("checked"),i.find(".modal-title").html("Edit Role"),$(".this_error_wrapper").hide(),$("#updateRole").show(),$("#saveRole").hide();var a=$("#roles-"+s+"-name").text(),r=$("#roles-"+s+"-description").text(),o=$("#baseUrl").val()+"roles/"+s+"/actions";$.ajax({type:"GET",url:o,success:function(e){for(var s=e.length,o=0;o<s;o++){var n=e[o];i.find("#"+n.code).prop("checked",1==n.pivot.permitted)}i.find("#roleName").val(a),i.find("#description").val(r),$("input:checkbox.main-permission").each(function(){var e=$(this).attr("id");switch(e){case"access_contacts":this.checked?$("#contactPermissions").show():$("#contactPermissions").hide();break;case"access_affiliates":this.checked?$("#affiliatesPermissions").show():$("#affiliatesPermissions").hide();break;case"access_campaigns":this.checked?($("#campaignPermissions").show(),$("#campaignInfoPermissions").show()):($("#campaignPermissions").hide(),$("#campaignInfoPermissions").hide());break;case"access_advertisers":this.checked?$("#advertisersPermissions").show():$("#advertisersPermissions").hide();break;case"access_filter_types":this.checked?$("#filterTypesPermissions").show():$("#filterTypesPermissions").hide();break;case"access_revenue_trackers":this.checked?$("#revenueTrackersPermissions").show():$("#revenueTrackersPermissions").hide();break;case"access_gallery":this.checked?$("#galleryPermissions").show():$("#galleryPermissions").hide();break;case"access_categories":this.checked?$("#categoriesPermissions").show():$("#categoriesPermissions").hide()}}),i.modal("show")},error:function(e,s,i){alert(i)}})}),$(document).on("click",".deleteRole",function(){var e=$(this),s=e.data("id");if(1==s)return void alert("This role cannot be deleted!");if(confirm("Are you sure you want to delete this role?")){var i=$("#baseUrl").val()+"roles/"+s+"/delete";$.ajax({type:"GET",url:i,success:function(s){if(s.success){alert(s.message);var i=$("#roles-table").DataTable();i.row(e.parents("tr")).remove().draw()}},error:function(e,s,i){alert(i)}})}});
//# sourceMappingURL=roles.min.js.map
