$(document).ready(function(){function e(){var e=$("#external_path_revenue"),t=$("#external_path_revenue tbody"),a=$("#external_path_revenue tfoot tr");a.find(":nth-child(2)").html("$0.00"),e.DataTable().destroy(),t.empty(),$.ajax({type:"GET",url:l.html()+"/affiliate/externalPathStatistics",data:{period:$("#hosted_filter").val(),start_date:$("#hosted_start_date").val(),end_date:$("#hosted_end_date").val()},success:function(d){var l=0,r=0,n=0,o=d.publisher_revenue_share,s=o/100;$("#publisherRevenueSharePerc").html(o),$.each(d.records,function(e,a){var d=null!=a.received?a.received.toFixed(2):0,o=null!=a.count?a.count:0,i=(d*s).toFixed(2),a='<tr class="row-button"><td>'+a.created_at+"</td><td>$ "+d+"</td><td>$ "+i+"</td></tr>";t.append(a),l+=Number(o),r+=Number(d),n+=Number(i)}),a.find(":nth-child(2)").html("$"+d.total_revenue),a.find(":nth-child(3)").html("$"+d.total_share),e.DataTable({responsive:!0,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]],columnDefs:[{searchable:!1,targets:[1]}],language:{searchPlaceholder:"Date"}}).draw()}})}function t(){var e=$("#host_posted_deals"),t=$("#host_posted_deals tbody");footer=$("#host_posted_deals tfoot tr"),footer.find(":nth-child(2)").html("0"),footer.find(":nth-child(3)").html("$0.00"),e.DataTable().destroy(),t.empty(),$.ajax({type:"GET",url:l.html()+"/affiliate/affiliateHostedStatistics",data:{period:$("#hosted_filter").val(),start_date:$("#hosted_start_date").val(),end_date:$("#hosted_end_date").val()},success:function(a){var d=a.campaigns,l=0,r=0;$.each(a.records,function(e,a){var n=null!=a.payout?a.payout.toFixed(2):0,o=null!=a.leads?a.leads:0,s='<span id="campaignStats-'+a.campaign_id+'-campaign_id" class="stats-col-campaign" data-campaign_id="'+a.campaign_id+'">'+d[a.campaign_id]+"</span>",a='<tr class="row-button"><td>'+s+"</td><td>"+o+"</td><td>$ "+n+"</td></tr>";t.append(a),l+=Number(o),r+=Number(n)}),footer.find(":nth-child(2)").html(l),footer.find(":nth-child(3)").html("$"+r.toFixed(2)),e.DataTable({responsive:!0,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]],columnDefs:[{searchable:!1,targets:[1,2]}],language:{searchPlaceholder:"Campaign"}}).draw()}})}function a(){var e=$("#website_statistics"),t=$("#website_statistics tbody"),a=$("#website_statistics tfoot tr");a.find(":nth-child(2)").html("0"),a.find(":nth-child(3)").html("$0.00"),e.DataTable().destroy(),t.empty(),$.ajax({type:"GET",url:l.html()+"/affiliate/affiliateWebsiteStatistics",data:{period:$("#modal_filter").val(),start_date:$("#modal_start_date").val(),end_date:$("#modal_end_date").val(),campaign_id:$("#campaign_id").val()},success:function(d){var l=0,r=0;$.each(d.records,function(e,a){var d=null!=a.payout?a.payout.toFixed(2):0,n=null!=a.leads?a.leads:0,a='<tr class="row-button"><td>'+a.website+"</td><td>"+n+"</td><td>$ "+d+"</td></tr>";t.append(a),l+=Number(n),r+=Number(d)}),a.find(":nth-child(2)").html(l),a.find(":nth-child(3)").html("$"+r.toFixed(2)),e.DataTable({responsive:!0,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]],columnDefs:[{searchable:!1,targets:[1,2]}],language:{searchPlaceholder:"Website"}}).draw()}})}function d(){var e=$("#reg_path_revenue"),t=$("#reg_path_revenue tbody"),a=$("#reg_path_revenue tfoot tr");a.find(":nth-child(2)").html("$0.00"),e.DataTable().destroy(),t.empty(),$.ajax({type:"GET",url:l.html()+"/affiliate/affiliateWebsiteViewsStatistics",data:{period:$("#hosted_filter").val(),start_date:$("#hosted_start_date").val(),end_date:$("#hosted_end_date").val()},success:function(d){console.log(d);var l=0,r=0,n=d.websites;$.each(d.records,function(e,a){var d=a.payout.toFixed(2),o=a.count,a='<tr class="row-button"><td data-id="'+a.website_id+'">'+n[a.website_id]+"</td><td> "+o+"</td><td>$ "+d+"</td></tr>";t.append(a),l+=Number(o),r+=Number(d)}),a.find(":nth-child(2)").html(l),a.find(":nth-child(3)").html("$"+r.toFixed(2)),e.DataTable({responsive:!0,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]],columnDefs:[{searchable:!1,targets:[1]}],language:{searchPlaceholder:"Website"},sDom:'l<"reg_path_revenue-addToolbar">frtip'}).draw(),$("div.reg_path_revenue-addToolbar").html('<label class="checkbox-inline"><input type="checkbox" name="reg_path_email" id="reg_path_email_checkbox" value="1" class="this_field"> Automatically send this report to email</label>'),$("#reg_path_email_checkbox").prop("checked",1==$("#reg_path_rev_email_value").val())}})}$(".date-range-picker").prop("readonly",!0),$('[data-toggle="tooltip"]').tooltip(),$(".input-group.date").datepicker({format:"yyyy-mm-dd",clearBtn:!0,autoclose:!0,todayHighlight:!0,orientation:"top auto",endDate:"-0d"});var l=$("#baseUrl");$("#external_path_revenue").DataTable({responsive:!0,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]],columnDefs:[{searchable:!1,targets:[1]}],language:{searchPlaceholder:"Date"}}),e(),$("#host_posted_deals").DataTable({responsive:!0,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]],columnDefs:[{searchable:!1,targets:[1,2]}],language:{searchPlaceholder:"Campaign"}}),$("#website_statistics").DataTable({responsive:!0,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]],columnDefs:[{searchable:!1,targets:[1,2]}],language:{searchPlaceholder:"Website"}}),t(),$("#reg_path_revenue").DataTable({responsive:!0,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]],columnDefs:[{searchable:!1,targets:[1]}],language:{searchPlaceholder:"Website"},sDom:'l<"reg_path_revenue-addToolbar">frtip'}),$("#reg_path_email_checkbox").prop("checked",1==$("#reg_path_rev_email_value").val()),d(),$(document).on("change","#reg_path_email_checkbox",function(){$(this).prop("checked");$.ajax({type:"GET",url:l.html()+"/affiliate/user_meta/update",data:{key:"reg_path_revenue_email_report",value:$("#reg_path_email_checkbox").prop("checked")?1:0},success:function(e){console.log(e)}})}),$("#predefined_form").submit(function(a){a.preventDefault(),$("#hosted_end_date").removeClass("error_field"),Date.parse($("#hosted_start_date").val())>Date.parse($("#hosted_end_date").val())?$("#hosted_end_date").addClass("error_field"):(t(),d(),e())}),$("#website_sub_revenue").submit(function(e){e.preventDefault(),a()}),$(document).on("click",".row-button",function(){var e=$("#hosted_start_date").val(),t=$("#hosted_end_date").val(),d=$("#hosted_filter").val();$("#modal_start_date").val(""),$("#modal_end_date").val(""),$("#modal_start_date").val(e),$("#modal_end_date").val(t),$("#modal_filter").val(d);var l=$(this).find("td:first"),r=$(l).find($("span")),n=r.data("campaign_id");if(void 0!=n){$("#campaign_id").val(n);var o=$("#campaignStats-"+n+"-campaign_id").text();$("#campaign_name").text(o),a(),$("#website_sub_revenue").modal("show")}}),$("#hosted_filter").change(function(){$("#hosted_start_date").val(""),$("#hosted_end_date").val("")}),$("#modal_filter").change(function(){$("#modal_start_date").val(""),$("#modal_end_date").val("")});var r="";$(".hosted-date-picker").on("propertychange change paste input",function(){$(this).val()!=r&&(r=$(this).val(),$("#hosted_filter").val(""))});var n="";$(".modal-date-picker").on("propertychange change paste input",function(){$(this).val()!=n&&(n=$(this).val(),$("#modal_filter").val(""))}),$(".hosted-date-picker").change(function(){$("#hosted_end_date").removeClass("error_field"),Date.parse($("#hosted_start_date").val())>Date.parse($("#hosted_end_date").val())&&$("#hosted_end_date").addClass("error_field")}),$(document).on("click","#reg_path_revenue tbody tr td:first-child",function(e){if($(this).parent("tr").children().length>1){var t=$("#regPathRevenueModal"),a=$(this).data("id");console.log(a);var d=$("#reg_path_breakdown-table"),r=$("#reg_path_breakdown-table tbody"),n=$("#reg_path_breakdown-table tfoot tr");n.find(":nth-child(2)").html(""),n.find(":nth-child(3)").html(""),d.DataTable().destroy(),r.empty(),$.ajax({type:"GET",url:l.html()+"/affiliate/getRegRevenueBreakdown",data:{period:$("#hosted_filter").val(),start_date:$("#hosted_start_date").val(),end_date:$("#hosted_end_date").val(),website_id:a},success:function(e){console.log(e);var t=0,a=0,l=e.payouts;$.each(e.records,function(e,d){var n=d.payout.toFixed(2),o=d.count;payout=1e3*Number(l[d.website_id]);var d='<tr class="row-button"><td>'+d.date+"</td><td> "+o+"</td><td> "+payout+" CPM</td><td>$ "+n+"</td></tr>";r.append(d),t+=Number(o),a+=Number(n)}),n.find(":nth-child(2)").html(t),n.find(":nth-child(4)").html("$"+a.toFixed(2)),d.DataTable({responsive:!0,searching:!1,lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"All"]]}).draw()}}),t.hasClass("in")||t.modal("show")}})});
//# sourceMappingURL=statistics.min.js.map
