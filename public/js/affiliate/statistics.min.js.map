{"version":3,"sources":["statistics.js"],"names":["$","document","ready","externalPathStatistics","table","body","footer","find","html","DataTable","destroy","empty","ajax","type","url","baseURL","data","period","val","start_date","end_date","success","total_leads","total_revenue","total_share","publisher_share","publisher_revenue_share","share_percentage","each","records","x","row","received","toFixed","leadCount","count","share","created_at","append","Number","responsive","lengthMenu","columnDefs","searchable","targets","language","searchPlaceholder","draw","hostPostAffiliateReport","campaigns","payout","leads","camp","campaign_id","campaignWebsiteBreakdown","website","affiliateWebsiteStatistics","console","log","total_passovers","websites","revenue","passover","website_id","sDom","prop","tooltip","datepicker","format","clearBtn","autoclose","todayHighlight","orientation","endDate","on","this","key","value","submit","e","preventDefault","removeClass","Date","parse","addClass","hostedStartDate","hostedEndDate","hostedPredefine","campaignColumn","campaign","campaignID","undefined","campaignName","text","modal","change","lastValue1","lastValue2","parent","children","length","payouts","date","searching","hasClass"],"mappings":"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","file":"statistics.min.js","sourcesContent":["$(document).ready(function()\r\n{\r\n    $('.date-range-picker').prop(\"readonly\", true);\r\n\r\n    $('[data-toggle=\"tooltip\"]').tooltip();\r\n\r\n    $('.input-group.date').datepicker({\r\n        format: \"yyyy-mm-dd\",\r\n        clearBtn: true,\r\n        autoclose: true,\r\n        todayHighlight: true,\r\n        orientation: \"top auto\",\r\n        endDate: '-0d'\r\n    });\r\n\r\n    var baseURL = $('#baseUrl');\r\n\r\n    var rowInitComplete = function(){\r\n        console.log('complete');\r\n        $('#host_posted_deals tr').each(function() {\r\n            var tableRow = $(this);\r\n            tableRow.addClass('row-button');\r\n        });\r\n    };\r\n\r\n    $('#external_path_revenue').DataTable({\r\n        responsive: true,\r\n        lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]],\r\n        \"columnDefs\": [\r\n            { \"searchable\": false, \"targets\": [1] }\r\n        ],\r\n        language: {\r\n            searchPlaceholder: \"Date\"\r\n        },\r\n    });\r\n    externalPathStatistics();\r\n    function externalPathStatistics() {\r\n        // console.log('host and post affiliate report')\r\n        // var the_url = baseURL + '/getHandPAffiliateReports';\r\n\r\n        var table = $('#external_path_revenue'),\r\n            body = $('#external_path_revenue tbody'),\r\n            footer = $('#external_path_revenue tfoot tr');\r\n\r\n        // footer.find(':nth-child(2)').html('0')\r\n        footer.find(':nth-child(2)').html('$0.00')\r\n        table.DataTable().destroy();\r\n        body.empty();\r\n\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: baseURL.html() + '/affiliate/externalPathStatistics',\r\n            data: {\r\n                period : $('#hosted_filter').val(),\r\n                start_date : $('#hosted_start_date').val(),\r\n                end_date : $('#hosted_end_date').val(),\r\n            },\r\n            success: function(data){\r\n                // console.log(data);\r\n                var total_leads = 0, total_revenue = 0.0, total_share = 0.0, publisher_share = data.publisher_revenue_share, \r\n                    share_percentage = publisher_share / 100; \r\n\r\n                $('#publisherRevenueSharePerc').html(publisher_share)\r\n\r\n                $.each(data.records, function(x, row){\r\n                    var received = row.received != null ? (row.received).toFixed(2) : 0.0,\r\n                        leadCount = row.count != null ? row.count : 0;\r\n\r\n                    var share = (received * share_percentage).toFixed(2);\r\n                    // var row = '<tr class=\"row-button\"><td>'+row.created_at+'</td><td>'+leadCount+'</td><td>$ '+payout+'</td></tr>';\r\n                    var row = '<tr class=\"row-button\"><td>'+row.created_at+'</td><td>$ '+received+'</td><td>$ '+share+'</td></tr>';\r\n                    body.append(row);\r\n\r\n                    total_leads += Number(leadCount);\r\n                    total_revenue += Number(received);\r\n                    total_share += Number(share);\r\n                });\r\n\r\n                // footer.find(':nth-child(2)').html(total_leads)\r\n                // footer.find(':nth-child(2)').html('$' + (total_revenue).toFixed(2))\r\n                // footer.find(':nth-child(3)').html('$' + (total_share).toFixed(2))\r\n                footer.find(':nth-child(2)').html('$' + data.total_revenue)\r\n                footer.find(':nth-child(3)').html('$' + data.total_share)\r\n\r\n                table.DataTable({\r\n                    responsive: true,\r\n                    lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]],\r\n                    \"columnDefs\": [\r\n                        { \"searchable\": false, \"targets\": [1] }\r\n                    ],\r\n                    language: {\r\n                        searchPlaceholder: \"Date\"\r\n                    },\r\n                }).draw();\r\n            }\r\n        });\r\n    }\r\n\r\n    $('#host_posted_deals').DataTable({\r\n        responsive: true,\r\n        lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]],\r\n        \"columnDefs\": [\r\n            { \"searchable\": false, \"targets\": [1,2] }\r\n        ],\r\n        language: {\r\n            searchPlaceholder: \"Campaign\"\r\n        },\r\n    });\r\n    $('#website_statistics').DataTable({\r\n        responsive: true,\r\n        lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]],\r\n        \"columnDefs\": [\r\n            { \"searchable\": false, \"targets\": [1,2] }\r\n        ],\r\n        language: {\r\n            searchPlaceholder: \"Website\"\r\n        },\r\n    });\r\n    // $('#handp-subid-table').DataTable();\r\n    \r\n    hostPostAffiliateReport();\r\n    function hostPostAffiliateReport() {\r\n        // console.log('host and post affiliate report')\r\n        // var the_url = baseURL + '/getHandPAffiliateReports';\r\n\r\n        var table = $('#host_posted_deals'),\r\n            body = $('#host_posted_deals tbody')\r\n            footer = $('#host_posted_deals tfoot tr');\r\n\r\n        footer.find(':nth-child(2)').html('0')\r\n        footer.find(':nth-child(3)').html('$0.00')\r\n        table.DataTable().destroy();\r\n        body.empty();\r\n\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: baseURL.html() + '/affiliate/affiliateHostedStatistics',\r\n            data: {\r\n                period : $('#hosted_filter').val(),\r\n                start_date : $('#hosted_start_date').val(),\r\n                end_date : $('#hosted_end_date').val(),\r\n            },\r\n            success: function(data){\r\n                //console.log(data);\r\n                var campaigns = data.campaigns;\r\n                var total_leads = 0, total_revenue = 0.0;\r\n                $.each(data.records, function(x, row){\r\n                    var payout = row.payout != null ? (row.payout).toFixed(2) : 0.0,\r\n                        leadCount = row.leads != null ? row.leads : 0,\r\n                        camp = '<span id=\"campaignStats-'+row.campaign_id+'-campaign_id\" class=\"stats-col-campaign\" data-campaign_id=\"'+row.campaign_id+'\">'+campaigns[row.campaign_id]+'</span>';\r\n                    var row = '<tr class=\"row-button\"><td>'+camp+'</td><td>'+leadCount+'</td><td>$ '+payout+'</td></tr>';\r\n                    body.append(row);\r\n\r\n                    total_leads += Number(leadCount);\r\n                    total_revenue += Number(payout);\r\n                });\r\n\r\n                footer.find(':nth-child(2)').html(total_leads)\r\n                footer.find(':nth-child(3)').html('$' + (total_revenue).toFixed(2))\r\n                table.DataTable({\r\n                    responsive: true,\r\n                    lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]],\r\n                    \"columnDefs\": [\r\n                        { \"searchable\": false, \"targets\": [1,2] }\r\n                    ],\r\n                    language: {\r\n                        searchPlaceholder: \"Campaign\"\r\n                    },\r\n                }).draw();\r\n            }\r\n        });\r\n    }\r\n\r\n    function campaignWebsiteBreakdown() {\r\n        var table = $('#website_statistics'),\r\n            body = $('#website_statistics tbody'),\r\n            footer = $('#website_statistics tfoot tr');\r\n\r\n\r\n        footer.find(':nth-child(2)').html('0')\r\n        footer.find(':nth-child(3)').html('$0.00')\r\n\r\n        table.DataTable().destroy();\r\n        body.empty();\r\n\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: baseURL.html() + '/affiliate/affiliateWebsiteStatistics',\r\n            data: {\r\n                period : $('#modal_filter').val(),\r\n                start_date : $('#modal_start_date').val(),\r\n                end_date : $('#modal_end_date').val(),\r\n                campaign_id : $('#campaign_id').val()\r\n            },\r\n            success: function(data){\r\n                // console.log(data);\r\n                var total_leads = 0, total_revenue = 0.0;\r\n                $.each(data.records, function(x, row){\r\n                    var payout = row.payout != null ? (row.payout).toFixed(2) : 0.0,\r\n                        leadCount = row.leads != null ? row.leads : 0;\r\n                    var row = '<tr class=\"row-button\"><td>'+row.website+'</td><td>'+leadCount+'</td><td>$ '+payout+'</td></tr>';\r\n                    body.append(row);\r\n                    total_leads += Number(leadCount);\r\n                    total_revenue += Number(payout);\r\n                });\r\n                footer.find(':nth-child(2)').html(total_leads)\r\n                footer.find(':nth-child(3)').html('$' + (total_revenue).toFixed(2))\r\n                table.DataTable({\r\n                    responsive: true,\r\n                    lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]],\r\n                    \"columnDefs\": [\r\n                        { \"searchable\": false, \"targets\": [1,2] }\r\n                    ],\r\n                    language: {\r\n                        searchPlaceholder: \"Website\"\r\n                    },\r\n                }).draw();\r\n            }\r\n        });\r\n    }\r\n    \r\n    // var regPathRevenue = $('#reg_path_revenue').DataTable({\r\n    //     'processing': true,\r\n    //     'serverSide': true,\r\n    //     'order': [], //disable the initial ordering\r\n    //     language: {\r\n    //         searchPlaceholder: \"Website\"\r\n    //     },\r\n    //     'drawCallback': function(settings) {\r\n    //         $('#reg_path_revenue tr').each(function() {\r\n    //             var tableRow = $(this);\r\n    //             tableRow.addClass('row-button');\r\n    //         });\r\n    //     },\r\n    //     'ajax':{\r\n    //         url: baseURL.html() + '/affiliate/affiliateWebsiteViewsStatistics',\r\n    //         type: 'GET',  // method  , by default get\r\n    //         'data': function(d)\r\n    //         {\r\n    //             d.website_view_start_date = $('#hosted_start_date').val();\r\n    //             d.website_view_end_date = $('#hosted_end_date').val();\r\n    //             d.website_view_filter = $('#hosted_filter').val();\r\n    //         },\r\n    //         error: function()\r\n    //         {\r\n    //             // error handling\r\n    //         }\r\n    //     },\r\n    //     'initComplete': rowInitComplete,\r\n    //     lengthMenu: [[20,50,100,-1],[20,50,100,'ALL']]\r\n    // });;\r\n\r\n    $('#reg_path_revenue').DataTable({\r\n        responsive: true,\r\n        lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]],\r\n        \"columnDefs\": [\r\n            { \"searchable\": false, \"targets\": [1] }\r\n        ],\r\n        language: {\r\n            searchPlaceholder: \"Website\"\r\n        },\r\n        \"sDom\": 'l<\"reg_path_revenue-addToolbar\">frtip'\r\n    });\r\n    $('#reg_path_email_checkbox').prop('checked', $('#reg_path_rev_email_value').val() == 1);\r\n\r\n    affiliateWebsiteStatistics();\r\n    function affiliateWebsiteStatistics() {\r\n        // console.log('host and post affiliate report')\r\n        // var the_url = baseURL + '/getHandPAffiliateReports';\r\n\r\n        var table = $('#reg_path_revenue'),\r\n            body = $('#reg_path_revenue tbody'),\r\n            footer = $('#reg_path_revenue tfoot tr');\r\n\r\n        // footer.find(':nth-child(1)').html('0')\r\n        footer.find(':nth-child(2)').html('$0.00')\r\n        table.DataTable().destroy();\r\n        body.empty();\r\n\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: baseURL.html() + '/affiliate/affiliateWebsiteViewsStatistics',\r\n            data: {\r\n                period : $('#hosted_filter').val(),\r\n                start_date : $('#hosted_start_date').val(),\r\n                end_date : $('#hosted_end_date').val(),\r\n            },\r\n            success: function(data){\r\n                console.log(data);\r\n                var total_passovers = 0, total_revenue = 0,\r\n                    websites = data.websites;\r\n                    // payouts = data.payouts;\r\n\r\n                $.each(data.records, function(x, row){\r\n                    var revenue = (row.payout).toFixed(2),\r\n                        passover = row.count;\r\n                        // payout = Number(payouts[row.website_id]) * 1000;\r\n\r\n\r\n\r\n                    var row = '<tr class=\"row-button\"><td data-id=\"'+row.website_id+'\">'+websites[row.website_id]+'</td><td> '+passover+'</td><td>$ '+revenue+'</td></tr>';\r\n                    body.append(row);\r\n\r\n                    total_passovers += Number(passover);\r\n                    total_revenue += Number(revenue);\r\n                });\r\n\r\n                // footer.find(':nth-child(2)').html(total_leads)\r\n                footer.find(':nth-child(2)').html((total_passovers))\r\n                footer.find(':nth-child(3)').html('$' + (total_revenue).toFixed(2))\r\n\r\n                table.DataTable({\r\n                    responsive: true,\r\n                    lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]],\r\n                    \"columnDefs\": [\r\n                        { \"searchable\": false, \"targets\": [1] }\r\n                    ],\r\n                    language: {\r\n                        searchPlaceholder: \"Website\"\r\n                    },\r\n                    \"sDom\": 'l<\"reg_path_revenue-addToolbar\">frtip'\r\n                }).draw();\r\n                $(\"div.reg_path_revenue-addToolbar\").html('<label class=\"checkbox-inline\"><input type=\"checkbox\" name=\"reg_path_email\" id=\"reg_path_email_checkbox\" value=\"1\" class=\"this_field\"> Automatically send this report to email</label>');\r\n                $('#reg_path_email_checkbox').prop('checked', $('#reg_path_rev_email_value').val() == 1);\r\n            }\r\n        });\r\n    }\r\n\r\n    $(document).on('change','#reg_path_email_checkbox', function() {\r\n        var value = $(this).prop('checked');\r\n        $.ajax({\r\n        type: 'GET',\r\n        url: baseURL.html() + '/affiliate/user_meta/update',\r\n        data: {\r\n            key : 'reg_path_revenue_email_report',\r\n            value : $('#reg_path_email_checkbox').prop('checked') ? 1 : 0\r\n        },\r\n        success: function(data){\r\n            console.log(data);\r\n        }\r\n    });\r\n\r\n    });\r\n\r\n    $('#predefined_form').submit(function(e)\r\n    {\r\n        e.preventDefault();\r\n        //Return to default\r\n        $('#hosted_end_date').removeClass('error_field');\r\n\r\n        //Check if dates are valid\r\n        if(Date.parse($('#hosted_start_date').val()) > Date.parse($('#hosted_end_date').val())) {\r\n            $('#hosted_end_date').addClass('error_field');\r\n        }else {\r\n            //remove the currently selected ordering\r\n            // hostPostedDealsDataTable.order([]);\r\n            // hostPostedDealsDataTable.ajax.reload(rowInitComplete);\r\n\r\n            hostPostAffiliateReport();\r\n\r\n            // regPathRevenue.order([]);\r\n            // regPathRevenue.ajax.reload();\r\n\r\n            affiliateWebsiteStatistics();\r\n\r\n            externalPathStatistics();\r\n\r\n        }\r\n    });\r\n\r\n    $('#website_sub_revenue').submit(function(e)\r\n    {\r\n        e.preventDefault();\r\n        //remove the currently selected ordering\r\n        // websiteStatisticsDataTable.order([]);\r\n        // websiteStatisticsDataTable.ajax.reload();\r\n        campaignWebsiteBreakdown();\r\n    });\r\n\r\n    //url for the website table server side\r\n    // var websiteStatisticsDataTable = $('#website_statistics').DataTable({\r\n    //     'processing': true,\r\n    //     'serverSide': true,\r\n    //     language: {\r\n    //         searchPlaceholder: \"Website\"\r\n    //     },\r\n    //     'order': [], //disable the initial ordering\r\n    //     'ajax':{\r\n    //          url: baseURL.html() + '/affiliate/affiliateWebsiteStatistics',\r\n    //          type: 'GET',  // method  , by default get\r\n    //          'data': function(d)\r\n    //          {\r\n    //              d.modal_start_date = $('#modal_start_date').val();\r\n    //              d.modal_end_date = $('#modal_end_date').val();\r\n    //              d.modal_filter = $('#modal_filter').val();\r\n    //              d.campaign_id = $('#campaign_id').val();\r\n    //          },\r\n    //          error: function(){  //error handling\r\n    //          }\r\n    //     },\r\n    //     lengthMenu: [[20,50,100,-1],[20,50,100,'ALL']]\r\n    // });\r\n\r\n    $(document).on('click','.row-button', function() {\r\n        //get the form input from the parent\r\n        var hostedStartDate = $('#hosted_start_date').val();\r\n        var hostedEndDate = $('#hosted_end_date').val();\r\n        var hostedPredefine = $('#hosted_filter').val();\r\n\r\n        //clear the data range\r\n        $('#modal_start_date').val('');\r\n        $('#modal_end_date').val('');\r\n\r\n        //assign form values\r\n        $('#modal_start_date').val(hostedStartDate);\r\n        $('#modal_end_date').val(hostedEndDate);\r\n        $('#modal_filter').val(hostedPredefine);\r\n\r\n        var campaignColumn = $(this).find('td:first');\r\n        var campaign = $(campaignColumn).find($('span'));\r\n        var campaignID = campaign.data('campaign_id');\r\n\r\n        if(campaignID==undefined)\r\n        {\r\n            return;\r\n        }\r\n\r\n        //assign the proper campaign ID\r\n        $('#campaign_id').val(campaignID);\r\n        // console.log(campaignID);\r\n        // console.log(hostedPredefine);\r\n\r\n        //get the campaign name ang copy it to the modal title\r\n        var campaignName = $('#campaignStats-'+campaignID+'-campaign_id').text();\r\n        $('#campaign_name').text(campaignName);\r\n\r\n        campaignWebsiteBreakdown();\r\n\r\n        // //clear the search filter\r\n        // websiteStatisticsDataTable.search('');\r\n        // //reload the data set\r\n        // websiteStatisticsDataTable.ajax.reload();\r\n\r\n        $('#website_sub_revenue').modal('show');\r\n\r\n    });\r\n\r\n    $('#hosted_filter').change(function()\r\n    {\r\n        //clear the date range\r\n        $('#hosted_start_date').val('');\r\n        $('#hosted_end_date').val('');\r\n    });\r\n\r\n    $('#modal_filter').change(function()\r\n    {\r\n        //clear the date range\r\n        $('#modal_start_date').val('');\r\n        $('#modal_end_date').val('');\r\n    });\r\n\r\n    var lastValue1 = '';\r\n    $('.hosted-date-picker').on('propertychange change paste input',function()\r\n    {\r\n        if ($(this).val() != lastValue1) {\r\n            lastValue1 = $(this).val();\r\n            $('#hosted_filter').val('');\r\n        }\r\n    });\r\n\r\n    var lastValue2 = '';\r\n    $('.modal-date-picker').on('propertychange change paste input',function()\r\n    {\r\n        if ($(this).val() != lastValue2) {\r\n            lastValue2 = $(this).val();\r\n            $('#modal_filter').val('');\r\n        }\r\n    });\r\n\r\n    $('.hosted-date-picker').change(function() {\r\n        //Return to default\r\n        $('#hosted_end_date').removeClass('error_field');\r\n\r\n        //Check if dates are valid\r\n        if(Date.parse($('#hosted_start_date').val()) > Date.parse($('#hosted_end_date').val())) {\r\n            $('#hosted_end_date').addClass('error_field');\r\n        }\r\n    });\r\n\r\n    $(document).on('click','#reg_path_revenue tbody tr td:first-child', function(e){\r\n\r\n        if($(this).parent('tr').children().length > 1)\r\n        {\r\n            var modal = $('#regPathRevenueModal'),\r\n                website_id = $(this).data('id');\r\n            console.log(website_id)\r\n            var table = $('#reg_path_breakdown-table'),\r\n                body = $('#reg_path_breakdown-table tbody'),\r\n                footer = $('#reg_path_breakdown-table tfoot tr');\r\n            footer.find(':nth-child(2)').html('')\r\n            footer.find(':nth-child(3)').html('')\r\n            table.DataTable().destroy();\r\n            body.empty();\r\n            $.ajax({\r\n                type: 'GET',\r\n                url: baseURL.html() + '/affiliate/getRegRevenueBreakdown',\r\n                data: {\r\n                    period : $('#hosted_filter').val(),\r\n                    start_date : $('#hosted_start_date').val(),\r\n                    end_date : $('#hosted_end_date').val(),\r\n                    website_id: website_id\r\n                },\r\n                success: function(data){\r\n                    console.log(data);\r\n                    var total_passovers = 0, total_revenue = 0,\r\n                        payouts = data.payouts;\r\n\r\n                    $.each(data.records, function(x, row){\r\n                        var revenue = (row.payout).toFixed(2),\r\n                            passover = row.count;\r\n                            payout = Number(payouts[row.website_id]) * 1000;\r\n                        var row = '<tr class=\"row-button\"><td>'+row.date+'</td><td> '+passover+'</td><td> '+payout+' CPM</td><td>$ '+revenue+'</td></tr>';\r\n                        body.append(row);\r\n\r\n                        total_passovers += Number(passover);\r\n                        total_revenue += Number(revenue);\r\n                    });\r\n\r\n                    // footer.find(':nth-child(2)').html(total_leads)\r\n                    footer.find(':nth-child(2)').html((total_passovers))\r\n                    footer.find(':nth-child(4)').html('$' + (total_revenue).toFixed(2))\r\n\r\n                    table.DataTable({\r\n                        responsive: true,\r\n                        searching: false,\r\n                        lengthMenu: [[10,15,25,50,100,-1],[10,15,25,50,100,\"All\"]]\r\n                    }).draw();\r\n                    \r\n                }\r\n            });\r\n\r\n            if(!modal.hasClass('in'))\r\n            {\r\n                modal.modal('show');\r\n            }\r\n        }\r\n    });\r\n\r\n});\r\n"]}